(this["webpackJsonpgo-go-bus"]=this["webpackJsonpgo-go-bus"]||[]).push([[0],{44:function(n,t,e){},68:function(n,t,e){"use strict";e.r(t);var a,i,o,c,r,l,s,u,d,p,b,x,h,f,j,g,m,v,O,y,w,k,S,C,T,D,I,F,E,P,N,B,R,z,L,U,A,M,H=e(1),Z=e.n(H),Y=e(30),_=e.n(Y),q=(e(44),e(3)),$=e(10),G=e(2),K=e(0),W=Object(H.createContext)(),J=function(){return Object(H.useContext)(W)},V=function(n){var t=n.children,e=Z.a.useState(null),a=Object(G.a)(e,2),i=a[0],o=a[1];return Object(K.jsx)(W.Provider,{value:{locationData:i,setLocationData:o},children:t})},X=e.p+"static/media/logo.3b870a01.svg",Q=e.p+"static/media/ic-search.0c43b694.svg",nn=e.p+"static/media/ic-map-pin.1994c556.svg",tn=e.p+"static/media/ic-alert.f55b1580.svg",en=e(4),an=e(5),on=e.p+"static/media/ic-search-grey.fb4fa4f6.svg",cn=e.p+"static/media/ic-bus-main.8cadc9e9.svg",rn=e.p+"static/media/empty-card.a6a0934c.svg",ln=e.p+"static/media/dashed-line.fcf5307b.svg",sn=function(n){return"@media (min-width: 1024px){".concat(n,"}")},un="#ECEEFF",dn="#486AE8",pn={E:"\u6771\u884c",W:"\u897f\u884c",S:"\u5357\u884c",N:"\u5317\u884c",SE:"\u6771\u5357\u884c",NE:"\u6771\u5317\u884c",SW:"\u897f\u5357\u884c",NW:"\u897f\u5317\u884c"},bn={0:"\u6b63\u5e38",1:"\u5c1a\u672a\u767c\u8eca",2:"\u4ea4\u7ba1\u4e0d\u505c\u9760",3:"\u672b\u73ed\u8eca\u5df2\u904e",4:"\u4eca\u65e5\u672a\u71df\u904b"},xn="64958ee551c04190a4957935fc7071b8",hn="3fa_GOG04qfPPcd4A5o4WTKAkk8",fn="pk.eyJ1IjoiYWxseWNoZW4iLCJhIjoiY2t3M2Zrd2hoZTl3NDJvcGc1b2Nmc3hudCJ9.2k2cksPVg89sXBgmFra2Ww",jn=[{name:"\u81fa\u5317\u5e02",key:"Taipei",latlng:{lat:25.04454809288478,lng:121.53947779457634}},{name:"\u65b0\u5317\u5e02",key:"NewTaipei",latlng:{lng:121.4627838,lat:25.0170177}},{name:"\u6843\u5712\u5e02",key:"Taoyuan",latlng:{lng:121.3009071,lat:24.993682}},{name:"\u81fa\u4e2d\u5e02",key:"Taichung",latlng:{lng:120.6736565,lat:24.1477718}},{name:"\u81fa\u5357\u5e02",key:"Tainan",latlng:{lng:120.2268219,lat:22.9997997}},{name:"\u9ad8\u96c4\u5e02",key:"Kaohsiung",latlng:{lng:120.3014088,lat:22.6272419}},{name:"\u57fa\u9686\u5e02",key:"Keelung",latlng:{lng:121.7391586,lat:25.1275685}},{name:"\u65b0\u7af9\u5e02",key:"Hsinchu",latlng:{lng:120.9674549,lat:24.813849}},{name:"\u65b0\u7af9\u7e23",key:"HsinchuCounty",latlng:{lng:121.0177517,lat:24.8386986}},{name:"\u82d7\u6817\u7e23",key:"MiaoliCounty",latlng:{lng:120.8214569,lat:24.5602388}},{name:"\u5f70\u5316\u7e23",key:"ChanghuaCounty",latlng:{lng:120.5161572,lat:24.0517939}},{name:"\u5357\u6295\u7e23",key:"NantouCounty",latlng:{lng:120.9718323,lat:23.9608425}},{name:"\u96f2\u6797\u7e23",key:"YunlinCounty",latlng:{lng:120.4313564,lat:23.7092168}},{name:"\u5609\u7fa9\u7e23",key:"ChiayiCounty",latlng:{lng:120.2554893,lat:23.4518294}},{name:"\u5609\u7fa9\u5e02",key:"Chiayi",latlng:{lng:120.4491234,lat:23.4800943}},{name:"\u5c4f\u6771\u7e23",key:"PingtungCounty",latlng:{lng:120.5488586,lat:22.5518792}},{name:"\u5b9c\u862d\u7e23",key:"YilanCounty",latlng:{lng:121.7537498,lat:24.7591271}},{name:"\u82b1\u84ee\u7e23",key:"HualienCounty",latlng:{lng:121.601572,lat:23.9871544}},{name:"\u81fa\u6771\u7e23",key:"TaitungCounty",latlng:{lng:121.1438155,lat:22.7613225}},{name:"\u91d1\u9580\u7e23",key:"KinmenCounty",latlng:{lng:118.3766556,lat:24.4493374}},{name:"\u6f8e\u6e56\u7e23",key:"PenghuCounty",latlng:{lng:119.5793152,lat:23.5712249}},{name:"\u9023\u6c5f\u7e23",key:"LienchiangCounty",latlng:{lng:119.9516487,lat:26.1602145}}],gn={TPE:"Taipei",TXG:"Taichung",KEE:"Keelung",TNN:"Tainan",KHH:"Kaohsiung",NWT:"NewTaipei",ILA:"YilanCounty",TAO:"Taoyuan",CYI:"Chiayi",HSQ:"HsinchuCounty",MIA:"MiaoliCounty",NAN:"NantouCounty",CHA:"ChanghuaCounty",HSZ:"Hsinchu",YUN:"YunlinCounty",CYQ:"ChiayiCounty",PIF:"PingtungCounty",HUA:"HualienCounty",TTT:"TaitungCounty",KIN:"KinmenCounty",PEN:"PenghuCounty",LIE:"LienchiangCounty"},mn=an.a.div(a||(a=Object(en.a)(["\nmin-height: 100vh;\n","\n"])),sn("\ndisplay: flex;\n")),vn=an.a.div(i||(i=Object(en.a)(["\npadding: 25px 26px 40px;\nflex: 1;\n","\n"])),sn("\npadding: 46px 82px 67px;\nmax-height: 100vh;\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 12px;\n}\n&::-webkit-scrollbar-thumb {\n  border-radius: 8px;\n  background: rgba(72,106,232,0.5);\n  border: 2px solid #F5F6FF;\n}\n")),On=an.a.h1(o||(o=Object(en.a)(["\nfont-size: 16px;\ntext-transform: uppercase;\ncolor: var(--light);\nwidth: 100%;\n",""])),sn("\nfont-size: 26px;\nletter-spacing: 1.5px;\nwidth: auto;\n")),yn=an.a.h2(c||(c=Object(en.a)(["\nfont-size: 20px;\ncolor: var(--text-medium);\nmargin-bottom: 1.5em;\n"]))),wn=an.a.h3(r||(r=Object(en.a)(["\ncolor: var(--light);\nfont-size: 18px;\nmargin-bottom: 0.5em;\n"]))),kn=an.a.hr(l||(l=Object(en.a)(["\nborder: 0;\nmargin: 0 0.5em;\nborder-right: 2px solid var(--light);\ndisplay: inline-block;\nvertical-align: -2px;\nheight: 0.8em;\n","\n"])),sn("\nborder-right-width: 3px;\n")),Sn=an.a.div(s||(s=Object(en.a)(["\nposition: relative;\nbackground: #FFFFFF;\nbox-shadow: 2px 4px 7px rgba(196, 196, 196, 0.11);\nborder-radius: 16px;\noverflow: hidden;\n"]))),Cn=an.a.button(u||(u=Object(en.a)(["\nborder: 0;\nbackground: none;\npadding: 0;\noutline: 0;\ncursor: pointer;\n&:hover {\n  opacity: 0.7\n}\n"]))),Tn=an.a.ul(d||(d=Object(en.a)(["\n> li {\n  line-height: 1.7;\n  > a {\n    display: block;\n    padding: 24px 20px;\n    font-weight: 500;\n    color: var(--text-medium);\n    font-size: 14px;\n    ","\n  }\n  &:nth-child(odd) {\n    background: #F6F7FF;\n  }\n  &:nth-child(even) {\n    background: #ECEEFF;\n  }\n   + li {\n    margin-top: 2px;\n  }\n}\nmax-height: calc(100vh - 380px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 6px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: var(--light);\n  border-radius: 6px;\n  &:hover {\n    background: var(--tint);\n  }\n}\n"])),sn("\n      padding: 24px 70px;\n      font-size: 18px;\n    ")),Dn=an.a.ul(p||(p=Object(en.a)(["\nmax-height: calc(100% - 40px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 5px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: #C4C4C4;\n  &:hover {\n    background: var(--text-medium);\n  }\n}\n> li {\n  line-height: 1.7;\n  font-size: 14px;\n  display: grid;\n  grid-template-columns: 1fr 80px 90px;\n  grid-column-gap: 12px;\n  padding: 0.25em 1.5em;\n  align-items: center;\n  &:nth-child(odd) {\n    background: #F2F2F2;\n  }\n  &:nth-child(even) {\n    background: #FEFCFC;\n  }\n}\n"]))),In=an.a.span(b||(b=Object(en.a)(["\nfont-weight: bold;\nletter-spacing: 0.05em;\ntext-align: center;\ncolor: ",";\n"])),(function(n){switch(n.children){case"\u9032\u7ad9\u4e2d":return"var(--secondary)";case"\u672b\u73ed\u8eca\u5df2\u904e":case"\u4eca\u65e5\u672a\u71df\u904b":case"\u5c1a\u672a\u767c\u8eca":return"var(--text-medium)";default:return"var(--light)"}})),Fn=an.a.span(x||(x=Object(en.a)(["\nfont-size: 12px;\ncolor: var(--light);\npadding-left: 32px;\nbackground: url(",") 12px center/11px no-repeat;\n"])),cn),En=an.a.ul(h||(h=Object(en.a)(["\ndisplay: flex;\nwidth: 100%;\n> li {\n  flex: 1;\n  padding: 0.75em 1em;\n  font-size: ",";\n  font-weight: bold;\n  background-color: #BFCDFF;\n  white-space: nowrap;\n  color: #fff;\n  text-align: center;\n  cursor: pointer;\n  &.active {\n    background-color: var(--light);\n    cursor: default;\n  }\n  &:first-child {\n    border-top-left-radius: 16px;\n  }\n  &:last-child {\n    border-top-right-radius: 16px;\n  }\n}\n"])),(function(n){return"small"===n.size?"14px":"18px"})),Pn=an.a.div(f||(f=Object(en.a)(["\nbox-shadow: 3px 2px 6px rgba(121, 121, 121, 0.25);\nbackground: var(--light);\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\n","\n"])),sn("\nborder-radius: 16px;\ndisplay: block;\n")),Nn=Object(an.a)($.b)(j||(j=Object(en.a)(["\npadding: 14px;\ndisplay: block;\n> img {\n  width: 70px;\n}\n","\n"])),sn("\nborder-bottom: 1px solid rgba(255, 255, 255, 0.5);\npadding: 40px 20px;\n> img {\n  width: 100px;\n}\n")),Bn=an.a.ul(g||(g=Object(en.a)(["\ndisplay: flex;\nalign-items:center;\n","\n"])),sn("\nflex-direction: column;\n")),Rn=an.a.li(m||(m=Object(en.a)(["\nmargin-right: 16px;\n","\n"])),sn("\nmargin-top: 38px;\nmargin-right: 0;\n")),zn=Object(an.a)($.c)(v||(v=Object(en.a)(["\ndisplay: flex;\nalign-items: center;\njustify-content: center;\nwidth: 40px;\nheight: 40px;\nborder-radius: 16px;\n> img {\n  width: 24px;\n}\n&.active, &:hover {\n  background-color: #2A4AC2;\n}\n","\n"])),sn("\nwidth: 62px;\nheight: 62px;\n> img {\n  width: auto;\n}\n")),Ln=an.a.div(O||(O=Object(en.a)(["\nposition: fixed;\nleft: 0;\ntop: 0;\nright: 0;\nbottom: 0;\nbackground: #486ae880;\nz-index: 1000;\n"]))),Un=an.a.div(y||(y=Object(en.a)(["\noverflow-y: scroll;\nheight: 100vh;\nwidth: 100%;\ndisplay: flex;\nalign-items: center;\njustify-content: center;\n&::-webkit-scrollbar {\n  width: 0;\n}\n"]))),An=an.a.div(w||(w=Object(en.a)(["\nborder-radius: 16px;\nbackground: #fff;\npadding: 20px;\nmargin: 0 20px;\nwidth: 600px;\nposition: relative;\n"," {\n  position: absolute;\n  right: 12px;\n  top: 12px;\n}\n"," {\n  margin-right: 1em;\n}\n","\n"])),Cn,wn,sn("\npadding: 48px 36px;\nwidth: 1100px;\n")),Mn=an.a.div(k||(k=Object(en.a)(["\nheight: 360px;\nborder-radius: 16px;\nmargin-top: 20px;\n","\n"])),sn("\nmargin-top: 0px;\n")),Hn=an.a.input(S||(S=Object(en.a)(["\noutline: none;\nwidth: 100%;\nfont-family: inherit;\nbackground: url(",") right 24px center/18px no-repeat, #ffffff;\nbox-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\nborder-radius: 16px;\nborder: 0;\npadding: 8px 24px 8px 12px;\ntext-align: center;\ncolor: var(--text-dark);\n&::placeholder {\n  color: var(--text-medium);\n}\n","\n"])),on,sn("\nfont-size: 18px;\npadding: 12px 30px 12px 12px;\nbackground-size: 22px;\n")),Zn=an.a.div(C||(C=Object(en.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  ","\n"])),sn("\n    width: 300px;\n  ")),Yn=an.a.ul(T||(T=Object(en.a)(["\n  position: absolute;\n  z-index: 1001;\n  top: calc(100% + 16px);\n  box-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\n  border-radius: 16px;\n  overflow: hidden;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  width: 100%;\n  max-height: 140px;\n  overflow-y: scroll;\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n  &::-webkit-scrollbar-thumb {\n    background: ",";\n    border-radius: 6px;\n    border: 2px solid #F5F6FF;\n  }\n  &::-webkit-scrollbar-track {\n    background: #ffffff;\n    border: 2px solid #F5F6FF;\n  }\n"])),dn),_n=an.a.li(D||(D=Object(en.a)(["\n font-size: 18px;\n padding: 12px;\n text-align: center;\n cursor: pointer;\n background: #fff;\n &:nth-child(odd) {\n  background: #F5F6FF;\n }\n &:hover {\n  background: ",";\n }\n"])),un),qn=an.a.div(I||(I=Object(en.a)(["\ntext-align: center;\nbackground: url(",") center bottom 10%/cover no-repeat;\nheight: 35vw;\nmin-height: 240px;\nmax-height: calc(100vh - 390px);\npadding: 60px 30px;\n"])),rn),$n=an.a.div(F||(F=Object(en.a)(["\ncolor: #bfcdff;\nfont-size: 18px;\nletter-spacing: 0.05em;\n"]))),Gn=an.a.div(E||(E=Object(en.a)(["\ndisplay: flex;\nalign-items:center;\nflex-wrap: wrap;\njustify-content: flex-end;\nmargin-bottom: 16px;\n"," {\n  width: 160px;\n}\n"," {\n  margin-top: 10px;\n}\n","\n"])),Zn,On,sn("\njustify-content: space-between;\n".concat(On," {\n  order: -1;\n  margin-top: 0px;\n}\n").concat(Zn," {\n  width: 310px;\n  margin-bottom: 0px;\n}\n"))),Kn=an.a.div(P||(P=Object(en.a)(["\n","\n"])),sn("\nheight: calc(100vh - 200px);\nmin-height: 650px;\ndisplay:flex;\n")),Wn=an.a.div(N||(N=Object(en.a)(["\nflex-basis: 380px;\ndisplay: flex;\nflex-direction: column;\nmargin-bottom: 28px;\n","\n> div {\n  flex: 1;\n  max-height:calc(50% - 14px);\n  > div {\n    height: 100%;\n  }\n  &:first-child {\n    margin-bottom: 28px;\n  }\n}\n"," {\n  height: 100%;\n  min-height: 240px;\n  max-height: none;\n  padding: 40px 20px;\n","\n}\n"])),sn("\nmargin-right: 28px;\nmargin-bottom: 0px;\n"),qn,sn("\n  min-height: auto;\n")),Jn=an.a.div(B||(B=Object(en.a)(["\nflex: 1;\n"]))),Vn=an.a.div(R||(R=Object(en.a)(["\nposition: absolute;\nleft: 50%;\ntop: 30%;\ntransform: translate(-50%, 0);\nfont-size: 72px;\ncolor: #fff;\n"]))),Xn=an.a.div(z||(z=Object(en.a)(["\ndisplay: flex;\nalign-items: center;\npadding: 12px 6px;\nposition: relative;\n+ div {\n  border-top: 1px dashed transparent;\n  border-image: url('","') 1 1 round;\n}\n> img {\n  width: 20px;\n  margin-right: 16px;\n}\n&:after{\n  content: '';\n  border-top: 11px solid var(--text-light);\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  position: absolute;\n  top: 50%;\n  margin-top: -6px;\n  right: 32px;\n  z-index: 1;\n}\n"," {\n  top: calc(100% - 4px);\n  max-height: 125px;\n  max-width: 230px;\n}\n"," {\n  padding: 8px 12px;\n}\n"," {\n  background: none;\n  box-shadow: none;\n  font-weight: bold;\n  text-align: left;\n  font-size: 14px;\n  color: var(--text-dark);\n  &::placeholder {\n    color: var(--text-light);\n  }\n}\n"])),ln,Yn,_n,Hn),Qn=an.a.button(L||(L=Object(en.a)(["\nborder-radius: 20px;\nbackground: var(--light);\ntext-align: center;\ncolor: #fff;\npadding: 0.5em 1em;\nfont-weight: bold;\nfont-size: 16px;\nborder: 0;\nwidth: 90%;\ndisplay: block;\nmargin: 1em auto 0;\ncursor: pointer;\n"]))),nt=an.a.div(U||(U=Object(en.a)(["\nheight: 100%;\nmin-height: 360px;\nbox-shadow: 1px 4px 15px rgba(140, 140, 140, 0.25);\nborder-radius: 16px;\n.icon-number {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  border: 2px solid #fff;\n  background: var(--light);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  box-shadow: 2px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.icon-bus {\n  padding: 6px;\n  border-radius: 6px;\n  font-size: 10px;\n  text-align: center;\n  width: 72px;\n  background: var(--light);\n  color: #fff;\n  > img {\n    display: block;\n    margin: 0 auto;\n  }\n}\n"]))),tt=function(){return Object(K.jsxs)(Pn,{children:[Object(K.jsx)(Nn,{to:"/",children:Object(K.jsx)("img",{src:X})}),Object(K.jsxs)(Bn,{children:[Object(K.jsx)(Rn,{children:Object(K.jsx)(zn,{to:"nearby",children:Object(K.jsx)("img",{src:nn})})}),Object(K.jsx)(Rn,{children:Object(K.jsx)(zn,{to:"search",children:Object(K.jsx)("img",{src:Q})})}),Object(K.jsx)(Rn,{children:Object(K.jsx)(zn,{to:"news",children:Object(K.jsx)("img",{src:tn})})})]})]})},et=e(7),at=e(38),it=e(6),ot=e.n(it),ct=e(34),rt=e.n(ct),lt=e.p+"static/media/ic-point.821431dd.svg",st=e.p+"static/media/ic-map-marker.775b9a87.svg",ut=e.p+"static/media/ic-site.2a56fa56.svg",dt=e.p+"static/media/ic-bus.cd4a572c.svg",pt=e(19),bt=e.n(pt),xt=e(39),ht=e(35),ft=e(36),jt=e.n(ft),gt=e(37),mt=["method","url"],vt=function(){var n=Z.a.useState(!1),t=Object(G.a)(n,2),e=t[0],a=t[1];return Z.a.useEffect((function(){if("undefined"!==typeof window){var n=function(){a("undefined"===typeof window||window.innerWidth<1024)};return window.addEventListener("resize",n),n(),function(){return window.removeEventListener("resize",n)}}}),[]),e},Ot=function(){var n=(new Date).toGMTString(),t=new gt.a("SHA-1","TEXT");return t.setHMACKey(hn,"TEXT"),t.update("x-date: ".concat(n)),{HMAC:t.getHMAC("B64"),GMTString:n}},yt=function(){var n=Object(ht.a)(bt.a.mark((function n(t){var e,a,i,o,c,r,l,s,u,d;return bt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.method,a=void 0===e?"get":e,i=t.url,o=Object(xt.a)(t,mt),c=Ot(),r=c.HMAC,l=c.GMTString,s=null,n.prev=3,n.next=6,jt()(Object(et.a)({method:a,url:"".concat("https://ptx.transportdata.tw/MOTC").concat(i,"&$format=JSON"),responseType:"json",headers:{Authorization:'hmac username="'.concat(xn,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(r,'"'),"x-date":l}},o));case 6:u=n.sent,d=u.data,s=d,n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),console.log("api error: ",n.t0);case 14:return n.abrupt("return",s);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(t){return n.apply(this,arguments)}}(),wt=function(){var n=J(),t=n.locationData,e=n.setLocationData;return{locationData:t,getPosition:function(){navigator.geolocation.getCurrentPosition((function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})}))}}},kt=function(){var n=Object(q.g)(),t=Z.a.useState([]),e=Object(G.a)(t,2),a=e[0],i=e[1],o=Z.a.useState(!1),c=Object(G.a)(o,2),r=c[0],l=c[1],s=Z.a.useRef(null);return Z.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==s.current&&l(!1)};return r&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[r]),Z.a.useEffect((function(){a.length>0&&l(!0)}),[a]),Object(K.jsxs)(Zn,{children:[Object(K.jsx)(Hn,{ref:s,type:"text",placeholder:"\u5feb\u901f\u641c\u5c0b",onChange:function(n){var t;n.target.value?(t=n.target.value,yt({url:"/v2/Bus/Route/City/Taipei/".concat(t,"?$top=10")}).then((function(n){i(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}))):i([])},onFocus:function(){return l(!0)}}),r&&Object(K.jsx)(Yn,{children:a.map((function(t){return Object(K.jsx)(_n,{onClick:function(){return e=t.value,void n("/search/Taipei/".concat(e));var e},children:t.label},t.label)}))})]})},St=function(n){var t=n.options,e=n.placeholder,a=n.onSelect,i=n.icon,o=n.defaultValue,c=Z.a.useState(""),r=Object(G.a)(c,2),l=r[0],s=r[1],u=Z.a.useState(!1),d=Object(G.a)(u,2),p=d[0],b=d[1],x=Z.a.useState([]),h=Object(G.a)(x,2),f=h[0],j=h[1],g=Z.a.useRef(null);return Z.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==g.current&&b(!1)};return p&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[p]),Z.a.useEffect((function(){t.length>0&&j(t)}),[t]),Z.a.useEffect((function(){if(o){var n=t.find((function(n){return n.value===o}));s(null===n||void 0===n?void 0:n.label)}}),[o]),Object(K.jsxs)(Xn,{children:[Object(K.jsx)("img",{src:i,alt:""}),Object(K.jsxs)(Zn,{children:[Object(K.jsx)(Hn,{ref:g,type:"text",value:l,placeholder:e,onChange:function(n){s(n.target.value),b(!0),n.target.value?j(t.filter((function(t){return t.label.includes(n.target.value)}))):j(t)},onFocus:function(){return b(!0)},autocomplete:"off"}),p&&Object(K.jsx)(Yn,{children:f.map((function(n){return Object(K.jsx)(_n,{onClick:function(){return s((t=n).label),void a(t.value);var t},children:n.label},n.label)}))})]})]})},Ct=e.p+"static/media/user-marker-point.739eb71e.svg",Tt=e.p+"static/media/ic-close.4b8e8462.svg",Dt=e.p+"static/media/ic-map-marker-main.dfbf20a3.svg",It=function(n){var t=n.data,e=n.close,a=n.showUserPopup,i=Z.a.useRef(),o=J().locationData,c=Z.a.useState([]),r=Object(G.a)(c,2),l=r[0],s=r[1];return Z.a.useEffect((function(){return A=function(n,t){var e=n.PositionLat,i=n.PositionLon,c=ot.a.map(t).setView([e,i],15);if(ot.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:fn}).addTo(c),ot.a.marker([e,i],{icon:ot.a.icon({iconUrl:Dt,iconAnchor:[10,23],popupAnchor:[0,-23]})}).addTo(c),o){var r=ot.a.marker([o.lat,o.lng],{icon:ot.a.icon({iconUrl:Ct,iconAnchor:[7,8],popupAnchor:[0,-6]})}).addTo(c);a&&r.bindPopup("\u76ee\u524d\u4f4d\u7f6e").openPopup()}return c}(t.StationPosition,i.current),function(){var n=gn[t.LocationCityCode];Promise.all([yt({url:"/v2/Bus/EstimatedTimeOfArrival/City/".concat(n,"/PassThrough/Station/").concat(t.StationID,"?")}),yt({url:"/v2/Bus/RealTimeNearStop/City/".concat(n,"/PassThrough/Station/").concat(t.StationID,"?")})]).then((function(n){var t=Object(G.a)(n,2),e=t[0],a=t[1];a.length>0&&a.forEach((function(n){var t=e.findIndex((function(t){return t.Direction===n.Direction&&t.SubRouteUID===n.SubRouteUID}));t>-1&&(e[t].BusPlate=n.PlateNumb)})),s(e.map((function(n){var t=n.EstimateTime?parseInt(n.EstimateTime/60):0;return!n.StopStatus||n.BusPlate?Object(et.a)(Object(et.a)({},n),{},{status:"".concat(t>1?"\u7d04".concat(t,"\u5206"):"\u9032\u7ad9\u4e2d")}):Object(et.a)(Object(et.a)({},n),{},{status:bn[n.StopStatus]})})))}))}(),function(){A.remove()}}),[]),Object(K.jsx)(Ln,{onClick:e,children:Object(K.jsx)(Un,{children:Object(K.jsxs)(An,{onClick:function(n){return n.stopPropagation()},children:[Object(K.jsx)(Cn,{onClick:e,type:"button",children:Object(K.jsx)("img",{src:Tt,alt:"x",width:"20"})}),Object(K.jsxs)(Kn,{style:{height:"auto",minHeight:"auto"},children:[Object(K.jsxs)(Wn,{children:[Object(K.jsxs)(wn,{children:[t.StationName.Zh_tw," - ",pn[t.Bearing]]}),Object(K.jsx)("small",{style:{marginBottom:12},children:t.StationAddress}),Object(K.jsx)(Dn,{children:l.map((function(n){return Object(K.jsxs)("li",{children:[Object(K.jsx)("span",{children:n.RouteName.Zh_tw}),Object(K.jsx)(In,{children:n.status}),n.BusPlate&&Object(K.jsx)(Fn,{children:n.BusPlate})]},n.RouteUID)}))})]}),Object(K.jsx)(Jn,{children:Object(K.jsx)(Mn,{ref:i})})]})]})})})},Ft=function(n){var t=n.text,e=void 0===t?"\u6c92\u6709\u8cc7\u6599":t;return Object(K.jsx)(qn,{children:Object(K.jsx)($n,{children:e})})},Et=e(12),Pt=e.n(Et);ot.a.NumberedIcon=ot.a.Icon.extend({options:{number:"",className:"icon-number",iconAnchor:[12,12],popupAnchor:[0,-12]},createIcon:function(){var n=document.createElement("div");return n.innerHTML=this.options.number||"",this._setIconStyles(n,"icon"),n}}),ot.a.BusIcon=ot.a.Icon.extend({options:{plateNumb:"",className:"icon-bus",iconAnchor:[36,18],popupAnchor:[0,-18]},createIcon:function(){var n=document.createElement("div"),t=document.createElement("img");return t.setAttribute("src",dt),n.appendChild(t),n.append(this.options.plateNumb||""),this._setIconStyles(n,"icon"),n}});var Nt=ot.a.layerGroup(),Bt=ot.a.layerGroup(),Rt=function(){var n,t,e=wt(),a=e.locationData,i=e.getPosition,o=Z.a.useRef(),c=Object(q.g)(),r=Object(q.h)(),l=r.city,s=r.route,u=Z.a.useState(""),d=Object(G.a)(u,2),p=d[0],b=d[1],x=Z.a.useState(null),h=Object(G.a)(x,2),f=h[0],j=h[1],g=Z.a.useState([]),m=Object(G.a)(g,2),v=m[0],O=m[1],y=Z.a.useState([]),w=Object(G.a)(y,2),k=w[0],S=w[1],C=Z.a.useState([]),T=Object(G.a)(C,2),D=T[0],I=T[1],F=Z.a.useState(null),E=Object(G.a)(F,2),P=E[0],N=E[1],B=Z.a.useState([]),R=Object(G.a)(B,2),z=R[0],L=R[1],U=Z.a.useState(""),A=Object(G.a)(U,2),H=A[0],Y=A[1],_=Z.a.useState(null),$=Object(G.a)(_,2),W=$[0],J=$[1],V=Z.a.useState(0),X=Object(G.a)(V,2),Q=X[0],nn=X[1],tn=vt(),en=function(n,t,e){Promise.all([yt({url:"/v2/Bus/RealTimeByFrequency/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),yt({url:"/v2/Bus/RealTimeNearStop/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),yt({url:"/v2/Bus/EstimatedTimeOfArrival/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")})]).then((function(n){var t=Object(G.a)(n,3),a=t[0],i=t[1],o=t[2],c=Object(at.a)(e);i.length>0&&i.forEach((function(n){var t=c.findIndex((function(t){return t.Direction===n.Direction&&t.SubRouteUID===n.SubRouteUID}));t>-1&&(c[t].Stops[n.StopSequence-1].BusPlate=n.PlateNumb,c[t].Stops[n.StopSequence-1].busStatus=n.DutyStatus)})),o.forEach((function(n){var t,e,a,i=n.EstimateTime?parseInt(n.EstimateTime/60):0,o=c.findIndex((function(t){return 255===n.Direction&&t.SubRouteUID===n.SubRouteUID||t.Direction===n.Direction&&t.RouteUID===n.RouteUID})),r=null===(t=c[o])||void 0===t?void 0:t.Stops.findIndex((function(t){return t.StopUID===n.StopUID}));r>-1&&(c[o].Stops[r].status=n.StopStatus?bn[n.StopStatus]:"".concat(i>1?"\u7d04".concat(i,"\u5206"):"\u9032\u7ad9\u4e2d")),1===(null===(e=c[o])||void 0===e||null===(a=e.Stops[r])||void 0===a?void 0:a.busStatus)&&(c[o].Stops[r].status="\u9032\u7ad9\u4e2d")})),S(a),I(c)}))},an=function(n){(function(n,t){return yt({url:"/v2/Bus/Stop/City/".concat(n,"?$filter=StopUID eq '").concat(t,"'&")})})(gn[n.StopUID.substr(0,3)],n.StopUID).then((function(n){var t=gn[n[0].LocationCityCode];yt({url:"/v2/Bus/Station/City/".concat(t,"?$filter=StationID eq '").concat(n[0].StationID,"'&")}).then((function(n){J(n[0])}))}))};Z.a.useEffect((function(){p||b(Pt()(new Date).format("HH:mm"));var n=setInterval((function(){b(Pt()(new Date).format("HH:mm"))}),2e3);return function(){clearInterval(n)}}),[p]),Z.a.useEffect((function(){var n,t;l&&s?(n=l,t=s,Promise.all([yt({url:"/v2/Bus/Route/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),yt({url:"/v2/Bus/StopOfRoute/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),yt({url:"/v2/Bus/Shape/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")})]).then((function(n){var t=Object(G.a)(n,3),e=t[0],a=t[1],i=t[2],o=e[0],c=a.map((function(n){return Object(et.a)(Object(et.a)({},n),{},{destination:0===n.Direction?o.DestinationStopNameZh:o.DepartureStopNameZh})}));N(o),Y(i[0].Geometry),L(c.filter((function(n,t){return t<2})))}))):(N(null),Y(""),L([]))}),[l,s]),Z.a.useEffect((function(){z.length>0&&en(l,s,z)}),[z]),Z.a.useEffect((function(){return H&&(M=function(n,t){var e=ot.a.GeoJSON.coordsToLatLngs(rt()(t).coordinates),a=ot.a.polyline(e,{color:dn}),i=a.getBounds(),o=i.getCenter(),c=ot.a.map(n).setView([o.lat,o.lng],15);return ot.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:fn}).addTo(c),a.addTo(c),c.fitBounds(i),c}(o.current,H)),!H&&a&&(M=function(n,t){var e=ot.a.map(n).setView([t?t.lat:25.04454809288478,t?t.lng:121.53947779457634],13);return ot.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:fn}).addTo(e),e}(o.current,a)),function(){M&&M.remove()}}),[H,a]),Z.a.useEffect((function(){var n;if(k.length>0){var t=function(){var n;en(l,s,z),k.map((function(n){return n.Direction})).includes(Q)&&(n=k.filter((function(n){return n.Direction===Q})),Nt.clearLayers(),n.forEach((function(n,t){var e=n.BusPosition,a=e.PositionLat,i=e.PositionLon;ot.a.marker([a,i],{icon:new ot.a.BusIcon({plateNumb:n.PlateNumb})}).addTo(Nt).bindPopup("".concat(n.Speed," kph"))})),Nt.addTo(M))};t(),n=setInterval(t,1e4)}return function(){clearInterval(n)}}),[k,Q]),Z.a.useEffect((function(){var n;z.length>0&&(n=z[Q].Stops,Bt.clearLayers(),n.forEach((function(n,t){var e=n.StopPosition,a=e.PositionLat,i=e.PositionLon;ot.a.marker([a,i],{icon:new ot.a.NumberedIcon({number:n.StopSequence})}).addTo(Bt).bindPopup(n.StopName.Zh_tw)})),Bt.addTo(M))}),[Q,z]),Z.a.useEffect((function(){l||s||i()}),[]);var on=null===(n=jn.find((function(n){return n.key===(null===P||void 0===P?void 0:P.City)})))||void 0===n?void 0:n.name;return Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)(Gn,{children:[Object(K.jsx)(kt,{}),Object(K.jsxs)(On,{children:["Route Search ",Object(K.jsx)(kn,{})," ",P?"".concat(on," - ").concat(P.RouteName.Zh_tw):" \u8def\u7dda\u641c\u5c0b "]})]}),Object(K.jsxs)(Kn,{children:[Object(K.jsxs)(Wn,{children:[Object(K.jsx)("div",{children:Object(K.jsxs)(Sn,{style:{padding:tn?"30px 30px 20px":"40px 30px 30px",overflow:"visible"},children:[Object(K.jsx)(yn,{style:{fontFamily:"DM Sans, Roboto, sans-serif",fontSize:24,marginBottom:"0.5em"},children:"Where are you going?"}),Object(K.jsx)(St,{options:jn.map((function(n){return{label:n.name,value:n.key}})),placeholder:"\u9078\u64c7 \u7e23\u5e02",onSelect:function(n){return t=n,j(Object(et.a)(Object(et.a)({},f),{},{city:t})),void yt({url:"/v2/Bus/Route/City/".concat(t,"?")}).then((function(n){O(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}));var t},icon:lt}),Object(K.jsx)(St,{options:v,placeholder:"\u9078\u64c7 \u8def\u7dda",onSelect:function(n){return j(Object(et.a)(Object(et.a)({},f),{},{route:n}))},icon:st}),Object(K.jsx)(Qn,{onClick:function(){var n=f.city,t=f.route;c("/search/".concat(n,"/").concat(t))},type:"button",children:"\u641c\u5c0b"})]})}),tn&&Object(K.jsx)(nt,{ref:o,style:{marginBottom:28}}),Object(K.jsx)("div",{children:l&&s?Object(K.jsxs)(Sn,{children:[Object(K.jsx)(En,{size:"small",children:z.map((function(n,t){return Object(K.jsxs)("li",{className:Q===t?"active":"",onClick:function(){nn(t)},children:["\u5f80 ",null===n||void 0===n?void 0:n.destination]},"".concat(n.Direction,"-").concat(n.SubRouteUID))}))}),Object(K.jsx)(Dn,{children:null===(t=D[Q])||void 0===t?void 0:t.Stops.map((function(n){return Object(K.jsxs)("li",{children:[Object(K.jsxs)("div",{children:[Object(K.jsx)(Cn,{type:"button",onClick:function(){return an(n)},style:{verticalAlign:-2,marginRight:6},children:Object(K.jsx)("img",{src:ut,alt:""})}),n.StopName.Zh_tw]}),Object(K.jsx)(In,{children:n.status}),n.BusPlate&&Object(K.jsx)(Fn,{children:n.BusPlate})]},n.StopID)}))})]}):Object(K.jsxs)(Sn,{children:[Object(K.jsx)(Ft,{text:"\u60a8\u9084\u6c92\u8f38\u5165\u8def\u7dda\u8cc7\u8a0a\u5594\uff01"}),Object(K.jsx)(Vn,{children:p})]})})]}),!tn&&Object(K.jsx)(Jn,{children:Object(K.jsx)(nt,{ref:o})}),W&&Object(K.jsx)(It,{data:W,close:function(){J(null)}})]})]})},zt=function(){var n=Z.a.useState(300),t=Object(G.a)(n,2),e=t[0],a=t[1],i=Z.a.useState([]),o=Object(G.a)(i,2),c=o[0],r=o[1],l=Z.a.useState(null),s=Object(G.a)(l,2),u=s[0],d=s[1],p=wt(),b=p.locationData,x=p.getPosition,h=vt();return Z.a.useEffect((function(){x()}),[]),Z.a.useEffect((function(){b&&e&&function(n){var t=n.lat,e=n.lng,a=n.distance;yt({url:"/v2/Bus/Station/NearBy?$spatialFilter=nearby(".concat(t,",").concat(e,",").concat(a,")")}).then((function(n){r(n.filter((function(n,t,e){return e.findIndex((function(t){return t.StationID===n.StationID}))===t})))}))}(Object(et.a)(Object(et.a)({},b),{},{distance:e}))}),[b,e]),Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)(Gn,{children:[Object(K.jsx)(kt,{}),Object(K.jsxs)(On,{children:["Bus Stop ",Object(K.jsx)(kn,{})," \u9644\u8fd1\u7ad9\u724c"]})]}),Object(K.jsxs)(Sn,{style:{padding:h?"40px 30px":"50px 70px",marginTop:20},children:[Object(K.jsx)(yn,{children:"\u9644\u8fd1\u7684\u7ad9\u724c"}),Object(K.jsxs)(En,{children:[Object(K.jsx)("li",{className:300===e?"active":"",onClick:function(){return a(300)},children:"300 m"}),Object(K.jsx)("li",{className:10===e?"active":"",onClick:function(){return a(10)},children:"100 m"})]}),c.length>0?Object(K.jsx)(Tn,{children:c.map((function(n,t){var e,a;return Object(K.jsx)("li",{children:Object(K.jsxs)($.b,{to:"#",onClick:function(t){return function(n,t){n.preventDefault(),d(t)}(t,n)},children:[Object(K.jsxs)(wn,{children:[null===(e=n.StationName)||void 0===e?void 0:e.Zh_tw," (",n.Bearing,")"]}),null===n||void 0===n||null===(a=n.Stops)||void 0===a?void 0:a.map((function(n){var t;return null===n||void 0===n||null===(t=n.RouteName)||void 0===t?void 0:t.Zh_tw})).join(", ")]})},n.StationUID)}))}):Object(K.jsx)(Ft,{text:"\u9644\u8fd1\u6c92\u6709\u7ad9\u724c"})]}),u&&Object(K.jsx)(It,{data:u,close:function(){d(null)},showUserPopup:!0})]})},Lt=function(){var n=Z.a.useState([]),t=Object(G.a)(n,2),e=t[0],a=t[1],i=Z.a.useState(null),o=Object(G.a)(i,2),c=o[0],r=o[1],l=Z.a.useState("Taipei"),s=Object(G.a)(l,2),u=s[0],d=s[1],p=vt(),b=function(){r(null)};return Z.a.useEffect((function(){yt({url:"/v2/Bus/News/City/".concat(u,"?$top=10")}).then((function(n){a(n)}))}),[u]),Object(K.jsxs)(K.Fragment,{children:[Object(K.jsxs)(On,{children:["Latest News ",Object(K.jsx)(kn,{})," \u6700\u65b0\u6d88\u606f"]}),Object(K.jsxs)(Sn,{style:{padding:p?"40px 30px":"50px 70px",marginTop:20},children:[Object(K.jsxs)(Gn,{style:{justifyContent:"space-between"},children:[Object(K.jsx)(yn,{children:"\u6700\u65b0\u6d88\u606f"}),Object(K.jsx)(St,{options:jn.map((function(n){return{label:n.name,value:n.key}})),placeholder:"\u9078\u64c7\u7e23\u5e02",defaultValue:u,onSelect:function(n){return d(n)},icon:st})]}),e.length>0?Object(K.jsx)(Tn,{children:e.map((function(n,t){return Object(K.jsx)("li",{children:Object(K.jsxs)($.b,{to:"#",onClick:function(t){return function(n,t){n.preventDefault(),r(t)}(t,n)},children:[Object(K.jsx)(wn,{children:Pt()(n.PublishTime).format("YYYY/MM/DD")}),n.Title]})},n.StationUID)}))}):Object(K.jsx)(Ft,{text:"\u6c92\u6709\u6700\u65b0\u6d88\u606f"})]}),c&&Object(K.jsx)(Ln,{onClick:b,children:Object(K.jsx)(Un,{children:Object(K.jsxs)(An,{onClick:function(n){return n.stopPropagation()},style:{width:750},children:[Object(K.jsx)(Cn,{onClick:b,type:"button",children:Object(K.jsx)("img",{src:Tt,alt:"x",width:"20"})}),Object(K.jsx)(wn,{children:c.Title}),Object(K.jsxs)("small",{children:[Pt()(c.PublishTime).format("YYYY/MM/DD HH:mm:ss")," | ",c.Department]}),Object(K.jsx)("hr",{}),c.Description]})})})]})},Ut=function(){return Object(K.jsxs)(mn,{children:[Object(K.jsx)(tt,{}),Object(K.jsx)(vn,{children:Object(K.jsx)(q.a,{})})]})},At=function(){return Object(K.jsx)(V,{children:Object(K.jsx)($.a,{children:Object(K.jsx)(q.d,{children:Object(K.jsxs)(q.b,{path:"/",element:Object(K.jsx)(Ut,{}),children:[Object(K.jsxs)(q.b,{path:"search",children:[Object(K.jsx)(q.b,{path:":city",element:Object(K.jsx)(Rt,{})}),Object(K.jsx)(q.b,{path:":city/:route",element:Object(K.jsx)(Rt,{})}),Object(K.jsx)(q.b,{index:!0,element:Object(K.jsx)(Rt,{})})]}),Object(K.jsx)(q.b,{path:"nearby",element:Object(K.jsx)(zt,{})}),Object(K.jsx)(q.b,{path:"news",element:Object(K.jsx)(Lt,{})}),Object(K.jsx)(q.b,{index:!0,element:Object(K.jsx)(Rt,{})})]})})})})},Mt=function(n){n&&n instanceof Function&&e.e(3).then(e.bind(null,69)).then((function(t){var e=t.getCLS,a=t.getFID,i=t.getFCP,o=t.getLCP,c=t.getTTFB;e(n),a(n),i(n),o(n),c(n)}))};_.a.render(Object(K.jsx)(Z.a.StrictMode,{children:Object(K.jsx)(At,{})}),document.getElementById("root")),Mt()}},[[68,1,2]]]);
//# sourceMappingURL=main.f2247b79.chunk.js.map