(this["webpackJsonpgo-go-bus"]=this["webpackJsonpgo-go-bus"]||[]).push([[0],{42:function(n,t,e){},66:function(n,t,e){"use strict";e.r(t);var a,i,o,r,c,l,s,u,d,p,b,x,h,g,f,j,m,v,O,y,w,k,S,C,F,D,E,I,T,z,R,N,B,P,L,U,M=e(0),A=e.n(M),Z=e(29),H=e.n(Z),_=(e(42),e(2)),q=e(10),W=e(5),G=e(1),$=Object(M.createContext)(),J=function(){return Object(M.useContext)($)},K=function(n){var t=n.children,e=A.a.useState(null),a=Object(W.a)(e,2),i=a[0],o=a[1];return Object(G.jsx)($.Provider,{value:{locationData:i,setLocationData:o},children:t})},Y=e.p+"static/media/logo.1a9be860.svg",V=e.p+"static/media/ic-search.3aeba931.svg",X=e.p+"static/media/ic-map-pin.1994c556.svg",Q=e.p+"static/media/ic-alert.d7a3da30.svg",nn=e(3),tn=e(4),en=e.p+"static/media/ic-search-grey.277928ec.svg",an=e.p+"static/media/ic-bus-main.922821e3.svg",on=e.p+"static/media/empty-card.79335666.svg",rn=e.p+"static/media/dashed-line.5a0970dc.svg",cn=function(n){return"@media (min-width: 1024px){".concat(n,"}")},ln="#ECEEFF",sn="#486AE8",un={E:"\u6771\u884c",W:"\u897f\u884c",S:"\u5357\u884c",N:"\u5317\u884c",SE:"\u6771\u5357\u884c",NE:"\u6771\u5317\u884c",SW:"\u897f\u5357\u884c",NW:"\u897f\u5317\u884c"},dn="64958ee551c04190a4957935fc7071b8",pn="3fa_GOG04qfPPcd4A5o4WTKAkk8",bn="pk.eyJ1IjoiYWxseWNoZW4iLCJhIjoiY2t3M2Zrd2hoZTl3NDJvcGc1b2Nmc3hudCJ9.2k2cksPVg89sXBgmFra2Ww",xn=[{name:"\u81fa\u5317\u5e02",key:"Taipei",latlng:{lat:25.04454809288478,lng:121.53947779457634}},{name:"\u65b0\u5317\u5e02",key:"NewTaipei",latlng:{lng:121.4627838,lat:25.0170177}},{name:"\u6843\u5712\u5e02",key:"Taoyuan",latlng:{lng:121.3009071,lat:24.993682}},{name:"\u81fa\u4e2d\u5e02",key:"Taichung",latlng:{lng:120.6736565,lat:24.1477718}},{name:"\u81fa\u5357\u5e02",key:"Tainan",latlng:{lng:120.2268219,lat:22.9997997}},{name:"\u9ad8\u96c4\u5e02",key:"Kaohsiung",latlng:{lng:120.3014088,lat:22.6272419}},{name:"\u57fa\u9686\u5e02",key:"Keelung",latlng:{lng:121.7391586,lat:25.1275685}},{name:"\u65b0\u7af9\u5e02",key:"Hsinchu",latlng:{lng:120.9674549,lat:24.813849}},{name:"\u65b0\u7af9\u7e23",key:"HsinchuCounty",latlng:{lng:121.0177517,lat:24.8386986}},{name:"\u82d7\u6817\u7e23",key:"MiaoliCounty",latlng:{lng:120.8214569,lat:24.5602388}},{name:"\u5f70\u5316\u7e23",key:"ChanghuaCounty",latlng:{lng:120.5161572,lat:24.0517939}},{name:"\u5357\u6295\u7e23",key:"NantouCounty",latlng:{lng:120.9718323,lat:23.9608425}},{name:"\u96f2\u6797\u7e23",key:"YunlinCounty",latlng:{lng:120.4313564,lat:23.7092168}},{name:"\u5609\u7fa9\u7e23",key:"ChiayiCounty",latlng:{lng:120.2554893,lat:23.4518294}},{name:"\u5609\u7fa9\u5e02",key:"Chiayi",latlng:{lng:120.4491234,lat:23.4800943}},{name:"\u5c4f\u6771\u7e23",key:"PingtungCounty",latlng:{lng:120.5488586,lat:22.5518792}},{name:"\u5b9c\u862d\u7e23",key:"YilanCounty",latlng:{lng:121.7537498,lat:24.7591271}},{name:"\u82b1\u84ee\u7e23",key:"HualienCounty",latlng:{lng:121.601572,lat:23.9871544}},{name:"\u81fa\u6771\u7e23",key:"TaitungCounty",latlng:{lng:121.1438155,lat:22.7613225}},{name:"\u91d1\u9580\u7e23",key:"KinmenCounty",latlng:{lng:118.3766556,lat:24.4493374}},{name:"\u6f8e\u6e56\u7e23",key:"PenghuCounty",latlng:{lng:119.5793152,lat:23.5712249}},{name:"\u9023\u6c5f\u7e23",key:"LienchiangCounty",latlng:{lng:119.9516487,lat:26.1602145}}],hn=tn.a.div(a||(a=Object(nn.a)(["\nmin-height: 100vh;\n","\n"])),cn("\ndisplay: flex;\n")),gn=tn.a.div(i||(i=Object(nn.a)(["\npadding: 25px 26px 40px;\nflex: 1;\n","\n"])),cn("\npadding: 46px 82px 67px;\nmax-height: 100vh;\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 12px;\n}\n&::-webkit-scrollbar-thumb {\n  border-radius: 8px;\n  background: rgba(72,106,232,0.5);\n  border: 2px solid #F5F6FF;\n}\n")),fn=tn.a.h1(o||(o=Object(nn.a)(["\nfont-size: 16px;\ntext-transform: uppercase;\ncolor: var(--light);\nwidth: 100%;\n",""])),cn("\nfont-size: 26px;\nletter-spacing: 1.5px;\nwidth: auto;\n")),jn=tn.a.h2(r||(r=Object(nn.a)(["\nfont-size: 20px;\ncolor: var(--text-medium);\nmargin-bottom: 1.5em;\n"]))),mn=tn.a.h3(c||(c=Object(nn.a)(["\ncolor: var(--light);\nfont-size: 18px;\nmargin-bottom: 0.5em;\n"]))),vn=tn.a.hr(l||(l=Object(nn.a)(["\nborder: 0;\nmargin: 0 0.5em;\nborder-right: 2px solid var(--light);\ndisplay: inline-block;\nvertical-align: -2px;\nheight: 0.8em;\n","\n"])),cn("\nborder-right-width: 3px;\n")),On=tn.a.div(s||(s=Object(nn.a)(["\nposition: relative;\nbackground: #FFFFFF;\nbox-shadow: 2px 4px 7px rgba(196, 196, 196, 0.11);\nborder-radius: 16px;\noverflow: hidden;\n"]))),yn=tn.a.ul(u||(u=Object(nn.a)(["\n> li {\n  line-height: 1.7;\n  > a {\n    display: block;\n    padding: 24px 20px;\n    font-weight: 500;\n    color: var(--text-medium);\n    font-size: 14px;\n    ","\n  }\n  &:nth-child(odd) {\n    background: #F6F7FF;\n  }\n  &:nth-child(even) {\n    background: #ECEEFF;\n  }\n   + li {\n    margin-top: 2px;\n  }\n}\nmax-height: calc(100vh - 380px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 6px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: var(--light);\n  border-radius: 6px;\n  &:hover {\n    background: var(--tint);\n  }\n}\n"])),cn("\n      padding: 24px 70px;\n      font-size: 18px;\n    ")),wn=tn.a.ul(d||(d=Object(nn.a)(["\nmax-height: calc(100% - 40px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 5px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: #C4C4C4;\n  &:hover {\n    background: var(--text-medium);\n  }\n}\n> li {\n  line-height: 1.7;\n  font-size: 14px;\n  display: grid;\n  grid-template-columns: 1fr 80px 90px;\n  grid-column-gap: 12px;\n  padding: 0.25em 1.5em;\n  align-items: center;\n  &:nth-child(odd) {\n    background: #F2F2F2;\n  }\n  &:nth-child(even) {\n    background: #FEFCFC;\n  }\n}\n"]))),kn=tn.a.span(p||(p=Object(nn.a)(["\nfont-weight: bold;\nletter-spacing: 0.05em;\ntext-align: center;\ncolor: ",";\n"])),(function(n){switch(n.children){case"\u9032\u7ad9\u4e2d":return"var(--secondary)";case"\u672b\u73ed\u8eca\u5df2\u904e":case"\u5c1a\u672a\u767c\u8eca":return"var(--text-medium)";default:return"var(--light)"}})),Sn=tn.a.span(b||(b=Object(nn.a)(["\nfont-size: 12px;\ncolor: var(--light);\npadding-left: 32px;\nbackground: url(",") 12px center/11px no-repeat;\n"])),an),Cn=tn.a.ul(x||(x=Object(nn.a)(["\ndisplay: flex;\nwidth: 100%;\n> li {\n  flex: 1;\n  padding: 0.75em 1em;\n  font-size: ",";\n  font-weight: bold;\n  background-color: #BFCDFF;\n  white-space: nowrap;\n  color: #fff;\n  text-align: center;\n  cursor: pointer;\n  &.active {\n    background-color: var(--light);\n    cursor: default;\n  }\n  &:first-child {\n    border-top-left-radius: 16px;\n  }\n  &:last-child {\n    border-top-right-radius: 16px;\n  }\n}\n"])),(function(n){return"small"===n.size?"14px":"18px"})),Fn=tn.a.div(h||(h=Object(nn.a)(["\nbox-shadow: 3px 2px 6px rgba(121, 121, 121, 0.25);\nbackground: var(--light);\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\n","\n"])),cn("\nborder-radius: 16px;\ndisplay: block;\n")),Dn=Object(tn.a)(q.b)(g||(g=Object(nn.a)(["\npadding: 14px;\ndisplay: block;\n> img {\n  width: 70px;\n}\n","\n"])),cn("\nborder-bottom: 1px solid rgba(255, 255, 255, 0.5);\npadding: 40px 20px;\n> img {\n  width: 100px;\n}\n")),En=tn.a.ul(f||(f=Object(nn.a)(["\ndisplay: flex;\nalign-items:center;\n","\n"])),cn("\nflex-direction: column;\n")),In=tn.a.li(j||(j=Object(nn.a)(["\nmargin-right: 16px;\n","\n"])),cn("\nmargin-top: 38px;\nmargin-right: 0;\n")),Tn=Object(tn.a)(q.b)(m||(m=Object(nn.a)(["\ndisplay: flex;\nalign-items: center;\njustify-content: center;\nwidth: 40px;\nheight: 40px;\nborder-radius: 16px;\n> img {\n  width: 24px;\n}\n&.active, &:hover {\n  background-color: #2A4AC2;\n}\n","\n"])),cn("\nwidth: 62px;\nheight: 62px;\n> img {\n  width: auto;\n}\n")),zn=tn.a.div(v||(v=Object(nn.a)(["\nposition: fixed;\nleft: 0;\ntop: 0;\nright: 0;\nbottom: 0;\nbackground: #486ae880;\nz-index: 1000;\n"]))),Rn=tn.a.div(O||(O=Object(nn.a)(["\noverflow-y: scroll;\nheight: 100vh;\nwidth: 100%;\ndisplay: flex;\nalign-items: center;\njustify-content: center;\n&::-webkit-scrollbar {\n  width: 0;\n}\n"]))),Nn=tn.a.div(y||(y=Object(nn.a)(["\nborder-radius: 16px;\nbackground: #fff;\npadding: 20px;\nmargin: 20px;\nwidth: 600px;\n","\n"])),cn("\npadding: 24px 36px;\n")),Bn=tn.a.div(w||(w=Object(nn.a)(["\nheight: 360px;\nborder-radius: 16px;\nmargin-top: 20px;\n"]))),Pn=tn.a.input(k||(k=Object(nn.a)(["\noutline: none;\nwidth: 100%;\nfont-family: inherit;\nbackground: url(",") right 24px center/18px no-repeat, #ffffff;\nbox-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\nborder-radius: 16px;\nborder: 0;\npadding: 8px 24px 8px 12px;\ntext-align: center;\ncolor: var(--text-dark);\n&::placeholder {\n  color: var(--text-medium);\n}\n","\n"])),en,cn("\nfont-size: 18px;\npadding: 12px 30px 12px 12px;\nbackground-size: 22px;\n")),Ln=tn.a.div(S||(S=Object(nn.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  ","\n"])),cn("\n    width: 300px;\n  ")),Un=tn.a.ul(C||(C=Object(nn.a)(["\n  position: absolute;\n  z-index: 1001;\n  top: calc(100% + 16px);\n  box-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\n  border-radius: 16px;\n  overflow: hidden;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  width: 100%;\n  max-height: 140px;\n  overflow-y: scroll;\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n  &::-webkit-scrollbar-thumb {\n    background: ",";\n    border-radius: 6px;\n    border: 2px solid #F5F6FF;\n  }\n  &::-webkit-scrollbar-track {\n    background: #ffffff;\n    border: 2px solid #F5F6FF;\n  }\n"])),sn),Mn=tn.a.li(F||(F=Object(nn.a)(["\n font-size: 18px;\n padding: 12px;\n text-align: center;\n cursor: pointer;\n background: #fff;\n &:nth-child(odd) {\n  background: #F5F6FF;\n }\n &:hover {\n  background: ",";\n }\n"])),ln),An=tn.a.div(D||(D=Object(nn.a)(["\ntext-align: center;\nbackground: url(",") center bottom 10%/cover no-repeat;\nheight: 30vw;\nmin-height: 240px;\nmax-height: 340px;\npadding: 60px 30px;\n"])),on),Zn=tn.a.div(E||(E=Object(nn.a)(["\ncolor: #bfcdff;\nfont-size: 18px;\nletter-spacing: 0.05em;\n"]))),Hn=tn.a.div(I||(I=Object(nn.a)(["\ndisplay: flex;\nalign-items:center;\nflex-wrap: wrap;\njustify-content: flex-end;\nmargin-bottom: 16px;\n"," {\n  width: 160px;\n  margin-bottom: 10px;\n}\n","\n"])),Ln,cn("\njustify-content: space-between;\n> h1 {\n  order: -1;\n}\n".concat(Ln," {\n  width: 310px;\n  margin-bottom: 0px;\n}\n"))),_n=tn.a.div(T||(T=Object(nn.a)(["\n","\n"])),cn("\nheight: calc(100vh - 200px);\nmin-height: 650px;\ndisplay:flex;\n")),qn=tn.a.div(z||(z=Object(nn.a)(["\nflex-basis: 380px;\ndisplay: flex;\nflex-direction: column;\nmargin-bottom: 28px;\n","\n> div {\n  flex: 1;\n  max-height:calc(50% - 14px);\n  > div {\n    height: 100%;\n  }\n  &:first-child {\n    margin-bottom: 28px;\n  }\n}\n"," {\n  height: 100%;\n  min-height: 240px;\n  max-height: none;\n  padding: 40px 20px;\n","\n}\n"])),cn("\nmargin-right: 28px;\nmargin-bottom: 0px;\n"),An,cn("\n  min-height: auto;\n")),Wn=tn.a.div(R||(R=Object(nn.a)(["\nflex: 1;\n"]))),Gn=tn.a.div(N||(N=Object(nn.a)(["\nposition: absolute;\nleft: 50%;\ntop: 30%;\ntransform: translate(-50%, 0);\nfont-size: 72px;\ncolor: #fff;\n"]))),$n=tn.a.div(B||(B=Object(nn.a)(["\ndisplay: flex;\nalign-items: center;\npadding: 12px 6px;\nposition: relative;\n+ div {\n  border-top: 1px dashed transparent;\n  border-image: url('","') 1 1 round;\n}\n> img {\n  width: 20px;\n  margin-right: 16px;\n}\n&:after{\n  content: '';\n  border-top: 11px solid var(--text-light);\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  position: absolute;\n  top: 50%;\n  margin-top: -6px;\n  right: 32px;\n  z-index: 1;\n}\n"," {\n  top: calc(100% - 4px);\n  max-height: 125px;\n  max-width: 230px;\n}\n"," {\n  padding: 8px 12px;\n}\n"," {\n  background: none;\n  box-shadow: none;\n  font-weight: bold;\n  text-align: left;\n  font-size: 14px;\n  color: var(--text-dark);\n  &::placeholder {\n    color: var(--text-light);\n  }\n}\n"])),rn,Un,Mn,Pn),Jn=tn.a.button(P||(P=Object(nn.a)(["\nborder-radius: 20px;\nbackground: var(--light);\ntext-align: center;\ncolor: #fff;\npadding: 0.5em 1em;\nfont-weight: bold;\nfont-size: 16px;\nborder: 0;\nwidth: 90%;\ndisplay: block;\nmargin: 1em auto 0;\ncursor: pointer;\n"]))),Kn=tn.a.div(L||(L=Object(nn.a)(["\nheight: 100%;\nmin-height: 360px;\nbox-shadow: 1px 4px 15px rgba(140, 140, 140, 0.25);\nborder-radius: 16px;\n.icon-number {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  border: 2px solid #fff;\n  background: var(--light);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  box-shadow: 2px 4px 4px rgba(0, 0, 0, 0.25);\n}\n"]))),Yn=function(){return Object(G.jsxs)(Fn,{children:[Object(G.jsx)(Dn,{to:"/",children:Object(G.jsx)("img",{src:Y})}),Object(G.jsxs)(En,{children:[Object(G.jsx)(In,{children:Object(G.jsx)(Tn,{to:"nearby",children:Object(G.jsx)("img",{src:X})})}),Object(G.jsx)(In,{children:Object(G.jsx)(Tn,{to:"search",children:Object(G.jsx)("img",{src:V})})}),Object(G.jsx)(In,{children:Object(G.jsx)(Tn,{to:"news",children:Object(G.jsx)("img",{src:Q})})})]})]})},Vn=e(9),Xn=e(6),Qn=e.n(Xn),nt=e(33),tt=e.n(nt),et=e.p+"static/media/ic-point.821431dd.svg",at=e.p+"static/media/ic-map-marker.5470742b.svg",it=e(17),ot=e.n(it),rt=e(37),ct=e(34),lt=e(35),st=e.n(lt),ut=e(36),dt=["method","url"],pt=function(){var n=A.a.useState(!1),t=Object(W.a)(n,2),e=t[0],a=t[1];return A.a.useEffect((function(){if("undefined"!==typeof window){var n=function(){a("undefined"===typeof window||window.innerWidth<1024)};return window.addEventListener("resize",n),n(),function(){return window.removeEventListener("resize",n)}}}),[]),e},bt=function(){var n=(new Date).toGMTString(),t=new ut.a("SHA-1","TEXT");return t.setHMACKey(pn,"TEXT"),t.update("x-date: ".concat(n)),{HMAC:t.getHMAC("B64"),GMTString:n}},xt=function(){var n=Object(ct.a)(ot.a.mark((function n(t){var e,a,i,o,r,c,l,s,u,d;return ot.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.method,a=void 0===e?"get":e,i=t.url,o=Object(rt.a)(t,dt),r=bt(),c=r.HMAC,l=r.GMTString,s=null,n.prev=3,n.next=6,st()(Object(Vn.a)({method:a,url:"".concat("https://ptx.transportdata.tw/MOTC").concat(i,"&$format=JSON"),responseType:"json",headers:{Authorization:'hmac username="'.concat(dn,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(c,'"'),"x-date":l}},o));case 6:u=n.sent,d=u.data,s=d,n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),console.log("api error: ",n.t0);case 14:return n.abrupt("return",s);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(t){return n.apply(this,arguments)}}(),ht=function(){var n=Object(_.g)(),t=A.a.useState([]),e=Object(W.a)(t,2),a=e[0],i=e[1],o=A.a.useState(!1),r=Object(W.a)(o,2),c=r[0],l=r[1],s=A.a.useRef(null);return A.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==s.current&&l(!1)};return c&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[c]),A.a.useEffect((function(){a.length>0&&l(!0)}),[a]),Object(G.jsxs)(Ln,{children:[Object(G.jsx)(Pn,{ref:s,type:"text",placeholder:"\u5feb\u901f\u641c\u5c0b",onChange:function(n){var t;n.target.value?(t=n.target.value,xt({url:"/v2/Bus/Route/City/Taipei/".concat(t,"?$top=10")}).then((function(n){i(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}))):i([])},onFocus:function(){return l(!0)}}),c&&Object(G.jsx)(Un,{children:a.map((function(t){return Object(G.jsx)(Mn,{onClick:function(){return e=t.value,void n("/search/Taipei/".concat(e));var e},children:t.label},t.label)}))})]})},gt=function(n){var t=n.options,e=n.placeholder,a=n.onSelect,i=n.icon,o=A.a.useState(""),r=Object(W.a)(o,2),c=r[0],l=r[1],s=A.a.useState(!1),u=Object(W.a)(s,2),d=u[0],p=u[1],b=A.a.useState([]),x=Object(W.a)(b,2),h=x[0],g=x[1],f=A.a.useRef(null);return A.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==f.current&&p(!1)};return d&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[d]),A.a.useEffect((function(){t.length>0&&g(t)}),[t]),Object(G.jsxs)($n,{children:[Object(G.jsx)("img",{src:i,alt:""}),Object(G.jsxs)(Ln,{children:[Object(G.jsx)(Pn,{ref:f,type:"text",value:c,placeholder:e,onChange:function(n){l(n.target.value),p(!0),n.target.value?g(t.filter((function(t){return t.label.includes(n.target.value)}))):g(t)},onFocus:function(){return p(!0)},autocomplete:"off"}),d&&Object(G.jsx)(Un,{children:h.map((function(n){return Object(G.jsx)(Mn,{onClick:function(){return l((t=n).label),void a(t.value);var t},children:n.label},n.label)}))})]})]})},ft=function(n){var t=n.text,e=void 0===t?"\u6c92\u6709\u8cc7\u6599":t;return Object(G.jsx)(An,{children:Object(G.jsx)(Zn,{children:e})})},jt=e(18),mt=e.n(jt),vt={0:"\u6b63\u5e38",1:"\u5c1a\u672a\u767c\u8eca",2:"\u4ea4\u7ba1\u4e0d\u505c\u9760",3:"\u672b\u73ed\u8eca\u5df2\u904e",4:"\u4eca\u65e5\u672a\u71df\u904b"};Qn.a.NumberedIcon=Qn.a.Icon.extend({options:{number:"",className:"icon-number",iconAnchor:[12,12],popupAnchor:[0,-12]},createIcon:function(){var n=document.createElement("div");return n.innerHTML=this.options.number||"",this._setIconStyles(n,"icon"),n}});var Ot,yt=function(n,t){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[],a=Qn.a.GeoJSON.coordsToLatLngs(tt()(t).coordinates),i=Qn.a.polyline(a,{color:sn}),o=i.getBounds(),r=o.getCenter(),c=Qn.a.map(n,{zoomControl:!1}).setView([r.lat,r.lng],15),l=Qn.a.layerGroup().addTo(c);return Qn.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:bn}).addTo(c),i.addTo(c),e.forEach((function(n,t){var e=n.StopPosition,a=e.PositionLat,i=e.PositionLon;Qn.a.marker([a,i],{icon:new Qn.a.NumberedIcon({number:n.StopSequence})}).addTo(l).bindPopup(n.StopName.Zh_tw)})),c.fitBounds(o),c},wt=function(){var n,t,e=A.a.useRef(),a=Object(_.g)(),i=Object(_.h)(),o=i.city,r=i.route,c=A.a.useState(""),l=Object(W.a)(c,2),s=l[0],u=l[1],d=A.a.useState(!1),p=Object(W.a)(d,2),b=p[0],x=p[1],h=A.a.useState(null),g=Object(W.a)(h,2),f=g[0],j=g[1],m=A.a.useState(null),v=Object(W.a)(m,2),O=v[0],y=v[1],w=A.a.useState([]),k=Object(W.a)(w,2),S=k[0],C=k[1],F=A.a.useState([]),D=Object(W.a)(F,2),E=D[0],I=D[1],T=A.a.useState(0),z=Object(W.a)(T,2),R=z[0],N=z[1],B=A.a.useState(""),P=Object(W.a)(B,2),L=P[0],M=P[1],Z=pt(),H=function(n,t){Promise.all([xt({url:"/v2/Bus/Route/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),xt({url:"/v2/Bus/StopOfRoute/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),xt({url:"/v2/Bus/RealTimeByFrequency/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),xt({url:"/v2/Bus/RealTimeNearStop/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),xt({url:"/v2/Bus/EstimatedTimeOfArrival/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),xt({url:"/v2/Bus/Shape/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")})]).then((function(n){var t=Object(W.a)(n,6),e=t[0],a=t[1],i=(t[2],t[3]),o=t[4],r=t[5],c=e[0];y(c);var l=a.map((function(n){return Object(Vn.a)(Object(Vn.a)({},n),{},{destination:0===n.Direction?c.DestinationStopNameZh:c.DepartureStopNameZh})}));i.length>0&&i.forEach((function(n){var t=l.findIndex((function(t){return t.Direction===n.Direction&&t.SubRouteUID===n.SubRouteUID}));t>-1&&(l[t].Stops[n.StopSequence-1].BusPlate=n.PlateNumb,l[t].Stops[n.StopSequence-1].busStatus=n.DutyStatus)})),o.forEach((function(n){var t,e,a,i=n.EstimateTime?parseInt(n.EstimateTime/60):0,o=l.findIndex((function(t){return 255===n.Direction&&t.SubRouteUID===n.SubRouteUID||t.Direction===n.Direction&&t.RouteUID===n.RouteUID})),r=null===(t=l[o])||void 0===t?void 0:t.Stops.findIndex((function(t){return t.StopUID===n.StopUID}));r>-1&&(l[o].Stops[r].status=n.StopStatus?vt[n.StopStatus]:"".concat(i>1?"\u7d04".concat(i,"\u5206"):"\u9032\u7ad9\u4e2d")),1===(null===(e=l[o])||void 0===e||null===(a=e.Stops[r])||void 0===a?void 0:a.busStatus)&&(l[o].Stops[r].status="\u9032\u7ad9\u4e2d")})),L||M(r[0].Geometry),I(l.filter((function(n,t){return t<2})))}))};A.a.useEffect((function(){s||u(mt()(new Date).format("HH:mm"));var n=setInterval((function(){u(mt()(new Date).format("HH:mm"))}),2e3);return function(){clearInterval(n)}}),[s]),A.a.useEffect((function(){var n=setInterval((function(){o&&r&&H(o,r)}),1e4);return function(){clearInterval(n)}}),[s,o,r]),A.a.useEffect((function(){!b&&E.length>0&&L&&(U=yt(e.current,L,E[R].Stops),x(!0),console.log("gogo"))}),[L,E]),A.a.useEffect((function(){return b&&(U=yt(e.current,L,E[R].Stops)),function(){U&&U.remove()}}),[R]),A.a.useEffect((function(){return function(){U&&U.remove()}}),[]),A.a.useEffect((function(){o&&r?(H(o,r),M("")):y(null)}),[o,r]);var q=null===(n=xn.find((function(n){return n.key===(null===O||void 0===O?void 0:O.City)})))||void 0===n?void 0:n.name;return Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)(Hn,{children:[Object(G.jsx)(ht,{}),Object(G.jsxs)(fn,{children:["Route Search ",Object(G.jsx)(vn,{})," ",O?"".concat(q," - ").concat(O.RouteName.Zh_tw):" \u8def\u7dda\u641c\u5c0b "]})]}),Object(G.jsxs)(_n,{children:[Object(G.jsxs)(qn,{children:[Object(G.jsx)("div",{children:Object(G.jsxs)(On,{style:{padding:Z?"30px 30px 20px":"40px 30px 30px",overflow:"visible"},children:[Object(G.jsx)(jn,{style:{fontFamily:"DM Sans, Roboto, sans-serif",fontSize:24,marginBottom:"0.5em"},children:"Where are you going?"}),Object(G.jsx)(gt,{options:xn.map((function(n){return{label:n.name,value:n.key}})),placeholder:"\u9078\u64c7 \u7e23\u5e02",onSelect:function(n){return t=n,j(Object(Vn.a)(Object(Vn.a)({},f),{},{city:t})),void xt({url:"/v2/Bus/Route/City/".concat(t,"?")}).then((function(n){C(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}));var t},icon:et}),Object(G.jsx)(gt,{options:S,placeholder:"\u9078\u64c7 \u8def\u7dda",onSelect:function(n){return j(Object(Vn.a)(Object(Vn.a)({},f),{},{route:n}))},icon:at}),Object(G.jsx)(Jn,{onClick:function(){var n=f.city,t=f.route;a("/search/".concat(n,"/").concat(t))},type:"button",children:"\u641c\u5c0b"})]})}),Object(G.jsx)("div",{children:o&&r?Object(G.jsxs)(On,{children:[Object(G.jsx)(Cn,{size:"small",children:E.map((function(n,t){return Object(G.jsxs)("li",{className:R===t?"active":"",onClick:function(){N(t)},children:["\u5f80 ",null===n||void 0===n?void 0:n.destination]},"".concat(n.Direction,"-").concat(n.SubRouteUID))}))}),Object(G.jsx)(wn,{children:null===(t=E[R])||void 0===t?void 0:t.Stops.map((function(n){return Object(G.jsxs)("li",{children:[Object(G.jsx)("span",{children:n.StopName.Zh_tw}),Object(G.jsx)(kn,{children:n.status}),n.BusPlate&&Object(G.jsx)(Sn,{children:n.BusPlate})]},n.StopID)}))})]}):Object(G.jsxs)(On,{children:[Object(G.jsx)(ft,{text:"\u60a8\u9084\u6c92\u8f38\u5165\u8def\u7dda\u8cc7\u8a0a\u5594\uff01"}),Object(G.jsx)(Gn,{children:s})]})})]}),Object(G.jsx)(Wn,{children:Object(G.jsx)(Kn,{ref:e})})]})]})},kt=e.p+"static/media/user-marker.832aa249.svg",St=e.p+"static/media/ic-map-marker-main.dfbf20a3.svg",Ct=function(n){var t=n.data,e=n.close,a=A.a.useRef(),i=J().locationData;return A.a.useEffect((function(){return Ot=function(n,t){var e=n.PositionLat,a=n.PositionLon,o=Qn.a.map(t).setView([e,a],15);return Qn.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:bn}).addTo(o),Qn.a.marker([e,a],{icon:Qn.a.icon({iconUrl:St,iconAnchor:[10,23],popupAnchor:[0,-23]})}).addTo(o),i&&Qn.a.marker([i.lat,i.lng],{icon:Qn.a.icon({iconUrl:kt,iconAnchor:[15,34],popupAnchor:[0,-34]})}).addTo(o),o}(t.StationPosition,a.current),function(){Ot.remove()}}),[]),Object(G.jsx)(zn,{onClick:e,children:Object(G.jsx)(Rn,{children:Object(G.jsxs)(Nn,{onClick:function(n){return n.stopPropagation()},children:[Object(G.jsxs)(mn,{children:[t.StationName.Zh_tw," - ",un[t.Bearing]]}),"\u884c\u7d93\u8def\u7dda\uff1a",t.Stops.map((function(n){return n.RouteName.Zh_tw})).join(", "),Object(G.jsx)(Bn,{ref:a})]})})})},Ft=function(){var n=A.a.useState(300),t=Object(W.a)(n,2),e=t[0],a=t[1],i=A.a.useState([]),o=Object(W.a)(i,2),r=o[0],c=o[1],l=A.a.useState(null),s=Object(W.a)(l,2),u=s[0],d=s[1],p=function(){var n=J(),t=n.locationData,e=n.setLocationData;return{locationData:t,getPosition:function(){navigator.geolocation.getCurrentPosition((function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})}))}}}(),b=p.locationData,x=p.getPosition,h=pt();return A.a.useEffect((function(){x()}),[]),A.a.useEffect((function(){b&&e&&function(n){var t=n.lat,e=n.lng,a=n.distance;xt({url:"/v2/Bus/Station/NearBy?$spatialFilter=nearby(".concat(t,",").concat(e,",").concat(a,")")}).then((function(n){c(n.filter((function(n,t,e){return e.findIndex((function(t){return t.StationID===n.StationID}))===t})))}))}(Object(Vn.a)(Object(Vn.a)({},b),{},{distance:e}))}),[b,e]),Object(G.jsxs)(G.Fragment,{children:[Object(G.jsxs)(Hn,{children:[Object(G.jsx)(ht,{}),Object(G.jsxs)(fn,{children:["Bus Stop ",Object(G.jsx)(vn,{})," \u9644\u8fd1\u7ad9\u724c"]})]}),Object(G.jsxs)(On,{style:{padding:h?"40px 30px":"50px 70px",marginTop:20},children:[Object(G.jsx)(jn,{children:"\u9644\u8fd1\u7684\u7ad9\u724c"}),Object(G.jsxs)(Cn,{children:[Object(G.jsx)("li",{className:300===e?"active":"",onClick:function(){return a(300)},children:"300 m"}),Object(G.jsx)("li",{className:10===e?"active":"",onClick:function(){return a(10)},children:"100 m"})]}),r.length>0?Object(G.jsx)(yn,{children:r.map((function(n,t){var e,a;return Object(G.jsx)("li",{children:Object(G.jsxs)(q.b,{to:"#",onClick:function(t){return function(n,t){n.preventDefault(),d(t)}(t,n)},children:[Object(G.jsxs)(mn,{children:[null===(e=n.StationName)||void 0===e?void 0:e.Zh_tw," (",n.Bearing,")"]}),null===n||void 0===n||null===(a=n.Stops)||void 0===a?void 0:a.map((function(n){var t;return null===n||void 0===n||null===(t=n.RouteName)||void 0===t?void 0:t.Zh_tw})).join(", ")]})},n.StationUID)}))}):Object(G.jsx)(ft,{text:"\u9644\u8fd1\u6c92\u6709\u7ad9\u724c"})]}),u&&Object(G.jsx)(Ct,{data:u,close:function(){d(null)}})]})},Dt=function(){return Object(G.jsxs)(fn,{children:["Latest News ",Object(G.jsx)(vn,{})," \u6700\u65b0\u6d88\u606f"]})},Et=function(){return Object(G.jsxs)(hn,{children:[Object(G.jsx)(Yn,{}),Object(G.jsx)(gn,{children:Object(G.jsx)(_.a,{})})]})},It=function(){return Object(G.jsx)(K,{children:Object(G.jsx)(q.a,{children:Object(G.jsx)(_.d,{children:Object(G.jsxs)(_.b,{path:"/",element:Object(G.jsx)(Et,{}),children:[Object(G.jsxs)(_.b,{path:"search",children:[Object(G.jsx)(_.b,{path:":city",element:Object(G.jsx)(wt,{})}),Object(G.jsx)(_.b,{path:":city/:route",element:Object(G.jsx)(wt,{})}),Object(G.jsx)(_.b,{index:!0,element:Object(G.jsx)(wt,{})})]}),Object(G.jsx)(_.b,{path:"nearby",element:Object(G.jsx)(Ft,{})}),Object(G.jsx)(_.b,{path:"news",element:Object(G.jsx)(Dt,{})}),Object(G.jsx)(_.b,{index:!0,element:Object(G.jsx)(wt,{})})]})})})})},Tt=function(n){n&&n instanceof Function&&e.e(3).then(e.bind(null,67)).then((function(t){var e=t.getCLS,a=t.getFID,i=t.getFCP,o=t.getLCP,r=t.getTTFB;e(n),a(n),i(n),o(n),r(n)}))};H.a.render(Object(G.jsx)(A.a.StrictMode,{children:Object(G.jsx)(It,{})}),document.getElementById("root")),Tt()}},[[66,1,2]]]);
//# sourceMappingURL=main.892c8f1d.chunk.js.map