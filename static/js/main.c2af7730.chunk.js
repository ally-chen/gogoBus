(this["webpackJsonpgo-go-bus"]=this["webpackJsonpgo-go-bus"]||[]).push([[0],{44:function(n,t,e){},68:function(n,t,e){"use strict";e.r(t);var a,i,o,c,r,l,s,u,d,p,b,x,h,f,g,m,j,v,O,y,w,k,S,C,F,D,I,E,T,N,z,R,B,P,L,M,A=e(0),U=e.n(A),Z=e(30),_=e.n(Z),H=(e(44),e(2)),q=e(10),G=e(5),W=e(1),$=Object(A.createContext)(),J=function(){return Object(A.useContext)($)},K=function(n){var t=n.children,e=U.a.useState(null),a=Object(G.a)(e,2),i=a[0],o=a[1];return Object(W.jsx)($.Provider,{value:{locationData:i,setLocationData:o},children:t})},V=e.p+"static/media/logo.3b870a01.svg",Y=e.p+"static/media/ic-search.0c43b694.svg",X=e.p+"static/media/ic-map-pin.1994c556.svg",Q=e.p+"static/media/ic-alert.f55b1580.svg",nn=e(3),tn=e(4),en=e.p+"static/media/ic-search-grey.fb4fa4f6.svg",an=e.p+"static/media/ic-bus-main.8cadc9e9.svg",on=e.p+"static/media/empty-card.a6a0934c.svg",cn=e.p+"static/media/dashed-line.fcf5307b.svg",rn=function(n){return"@media (min-width: 1024px){".concat(n,"}")},ln="#ECEEFF",sn="#486AE8",un={E:"\u6771\u884c",W:"\u897f\u884c",S:"\u5357\u884c",N:"\u5317\u884c",SE:"\u6771\u5357\u884c",NE:"\u6771\u5317\u884c",SW:"\u897f\u5357\u884c",NW:"\u897f\u5317\u884c"},dn="64958ee551c04190a4957935fc7071b8",pn="3fa_GOG04qfPPcd4A5o4WTKAkk8",bn="pk.eyJ1IjoiYWxseWNoZW4iLCJhIjoiY2t3M2Zrd2hoZTl3NDJvcGc1b2Nmc3hudCJ9.2k2cksPVg89sXBgmFra2Ww",xn=[{name:"\u81fa\u5317\u5e02",key:"Taipei",latlng:{lat:25.04454809288478,lng:121.53947779457634}},{name:"\u65b0\u5317\u5e02",key:"NewTaipei",latlng:{lng:121.4627838,lat:25.0170177}},{name:"\u6843\u5712\u5e02",key:"Taoyuan",latlng:{lng:121.3009071,lat:24.993682}},{name:"\u81fa\u4e2d\u5e02",key:"Taichung",latlng:{lng:120.6736565,lat:24.1477718}},{name:"\u81fa\u5357\u5e02",key:"Tainan",latlng:{lng:120.2268219,lat:22.9997997}},{name:"\u9ad8\u96c4\u5e02",key:"Kaohsiung",latlng:{lng:120.3014088,lat:22.6272419}},{name:"\u57fa\u9686\u5e02",key:"Keelung",latlng:{lng:121.7391586,lat:25.1275685}},{name:"\u65b0\u7af9\u5e02",key:"Hsinchu",latlng:{lng:120.9674549,lat:24.813849}},{name:"\u65b0\u7af9\u7e23",key:"HsinchuCounty",latlng:{lng:121.0177517,lat:24.8386986}},{name:"\u82d7\u6817\u7e23",key:"MiaoliCounty",latlng:{lng:120.8214569,lat:24.5602388}},{name:"\u5f70\u5316\u7e23",key:"ChanghuaCounty",latlng:{lng:120.5161572,lat:24.0517939}},{name:"\u5357\u6295\u7e23",key:"NantouCounty",latlng:{lng:120.9718323,lat:23.9608425}},{name:"\u96f2\u6797\u7e23",key:"YunlinCounty",latlng:{lng:120.4313564,lat:23.7092168}},{name:"\u5609\u7fa9\u7e23",key:"ChiayiCounty",latlng:{lng:120.2554893,lat:23.4518294}},{name:"\u5609\u7fa9\u5e02",key:"Chiayi",latlng:{lng:120.4491234,lat:23.4800943}},{name:"\u5c4f\u6771\u7e23",key:"PingtungCounty",latlng:{lng:120.5488586,lat:22.5518792}},{name:"\u5b9c\u862d\u7e23",key:"YilanCounty",latlng:{lng:121.7537498,lat:24.7591271}},{name:"\u82b1\u84ee\u7e23",key:"HualienCounty",latlng:{lng:121.601572,lat:23.9871544}},{name:"\u81fa\u6771\u7e23",key:"TaitungCounty",latlng:{lng:121.1438155,lat:22.7613225}},{name:"\u91d1\u9580\u7e23",key:"KinmenCounty",latlng:{lng:118.3766556,lat:24.4493374}},{name:"\u6f8e\u6e56\u7e23",key:"PenghuCounty",latlng:{lng:119.5793152,lat:23.5712249}},{name:"\u9023\u6c5f\u7e23",key:"LienchiangCounty",latlng:{lng:119.9516487,lat:26.1602145}}],hn=tn.a.div(a||(a=Object(nn.a)(["\nmin-height: 100vh;\n","\n"])),rn("\ndisplay: flex;\n")),fn=tn.a.div(i||(i=Object(nn.a)(["\npadding: 25px 26px 40px;\nflex: 1;\n","\n"])),rn("\npadding: 46px 82px 67px;\nmax-height: 100vh;\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 12px;\n}\n&::-webkit-scrollbar-thumb {\n  border-radius: 8px;\n  background: rgba(72,106,232,0.5);\n  border: 2px solid #F5F6FF;\n}\n")),gn=tn.a.h1(o||(o=Object(nn.a)(["\nfont-size: 16px;\ntext-transform: uppercase;\ncolor: var(--light);\nwidth: 100%;\n",""])),rn("\nfont-size: 26px;\nletter-spacing: 1.5px;\nwidth: auto;\n")),mn=tn.a.h2(c||(c=Object(nn.a)(["\nfont-size: 20px;\ncolor: var(--text-medium);\nmargin-bottom: 1.5em;\n"]))),jn=tn.a.h3(r||(r=Object(nn.a)(["\ncolor: var(--light);\nfont-size: 18px;\nmargin-bottom: 0.5em;\n"]))),vn=tn.a.hr(l||(l=Object(nn.a)(["\nborder: 0;\nmargin: 0 0.5em;\nborder-right: 2px solid var(--light);\ndisplay: inline-block;\nvertical-align: -2px;\nheight: 0.8em;\n","\n"])),rn("\nborder-right-width: 3px;\n")),On=tn.a.div(s||(s=Object(nn.a)(["\nposition: relative;\nbackground: #FFFFFF;\nbox-shadow: 2px 4px 7px rgba(196, 196, 196, 0.11);\nborder-radius: 16px;\noverflow: hidden;\n"]))),yn=tn.a.ul(u||(u=Object(nn.a)(["\n> li {\n  line-height: 1.7;\n  > a {\n    display: block;\n    padding: 24px 20px;\n    font-weight: 500;\n    color: var(--text-medium);\n    font-size: 14px;\n    ","\n  }\n  &:nth-child(odd) {\n    background: #F6F7FF;\n  }\n  &:nth-child(even) {\n    background: #ECEEFF;\n  }\n   + li {\n    margin-top: 2px;\n  }\n}\nmax-height: calc(100vh - 380px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 6px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: var(--light);\n  border-radius: 6px;\n  &:hover {\n    background: var(--tint);\n  }\n}\n"])),rn("\n      padding: 24px 70px;\n      font-size: 18px;\n    ")),wn=tn.a.ul(d||(d=Object(nn.a)(["\nmax-height: calc(100% - 40px);\noverflow-y: scroll;\n&::-webkit-scrollbar {\n  width: 5px;\n}\n&::-webkit-scrollbar-track {\n  background: #F6F7FF;\n}\n&::-webkit-scrollbar-thumb {\n  background: #C4C4C4;\n  &:hover {\n    background: var(--text-medium);\n  }\n}\n> li {\n  line-height: 1.7;\n  font-size: 14px;\n  display: grid;\n  grid-template-columns: 1fr 80px 90px;\n  grid-column-gap: 12px;\n  padding: 0.25em 1.5em;\n  align-items: center;\n  &:nth-child(odd) {\n    background: #F2F2F2;\n  }\n  &:nth-child(even) {\n    background: #FEFCFC;\n  }\n}\n"]))),kn=tn.a.span(p||(p=Object(nn.a)(["\nfont-weight: bold;\nletter-spacing: 0.05em;\ntext-align: center;\ncolor: ",";\n"])),(function(n){switch(n.children){case"\u9032\u7ad9\u4e2d":return"var(--secondary)";case"\u672b\u73ed\u8eca\u5df2\u904e":case"\u5c1a\u672a\u767c\u8eca":return"var(--text-medium)";default:return"var(--light)"}})),Sn=tn.a.span(b||(b=Object(nn.a)(["\nfont-size: 12px;\ncolor: var(--light);\npadding-left: 32px;\nbackground: url(",") 12px center/11px no-repeat;\n"])),an),Cn=tn.a.ul(x||(x=Object(nn.a)(["\ndisplay: flex;\nwidth: 100%;\n> li {\n  flex: 1;\n  padding: 0.75em 1em;\n  font-size: ",";\n  font-weight: bold;\n  background-color: #BFCDFF;\n  white-space: nowrap;\n  color: #fff;\n  text-align: center;\n  cursor: pointer;\n  &.active {\n    background-color: var(--light);\n    cursor: default;\n  }\n  &:first-child {\n    border-top-left-radius: 16px;\n  }\n  &:last-child {\n    border-top-right-radius: 16px;\n  }\n}\n"])),(function(n){return"small"===n.size?"14px":"18px"})),Fn=tn.a.div(h||(h=Object(nn.a)(["\nbox-shadow: 3px 2px 6px rgba(121, 121, 121, 0.25);\nbackground: var(--light);\ndisplay: flex;\njustify-content: space-between;\nalign-items: center;\n","\n"])),rn("\nborder-radius: 16px;\ndisplay: block;\n")),Dn=Object(tn.a)(q.b)(f||(f=Object(nn.a)(["\npadding: 14px;\ndisplay: block;\n> img {\n  width: 70px;\n}\n","\n"])),rn("\nborder-bottom: 1px solid rgba(255, 255, 255, 0.5);\npadding: 40px 20px;\n> img {\n  width: 100px;\n}\n")),In=tn.a.ul(g||(g=Object(nn.a)(["\ndisplay: flex;\nalign-items:center;\n","\n"])),rn("\nflex-direction: column;\n")),En=tn.a.li(m||(m=Object(nn.a)(["\nmargin-right: 16px;\n","\n"])),rn("\nmargin-top: 38px;\nmargin-right: 0;\n")),Tn=Object(tn.a)(q.b)(j||(j=Object(nn.a)(["\ndisplay: flex;\nalign-items: center;\njustify-content: center;\nwidth: 40px;\nheight: 40px;\nborder-radius: 16px;\n> img {\n  width: 24px;\n}\n&.active, &:hover {\n  background-color: #2A4AC2;\n}\n","\n"])),rn("\nwidth: 62px;\nheight: 62px;\n> img {\n  width: auto;\n}\n")),Nn=tn.a.div(v||(v=Object(nn.a)(["\nposition: fixed;\nleft: 0;\ntop: 0;\nright: 0;\nbottom: 0;\nbackground: #486ae880;\nz-index: 1000;\n"]))),zn=tn.a.div(O||(O=Object(nn.a)(["\noverflow-y: scroll;\nheight: 100vh;\nwidth: 100%;\ndisplay: flex;\nalign-items: center;\njustify-content: center;\n&::-webkit-scrollbar {\n  width: 0;\n}\n"]))),Rn=tn.a.div(y||(y=Object(nn.a)(["\nborder-radius: 16px;\nbackground: #fff;\npadding: 20px;\nmargin: 20px;\nwidth: 600px;\n","\n"])),rn("\npadding: 24px 36px;\n")),Bn=tn.a.div(w||(w=Object(nn.a)(["\nheight: 360px;\nborder-radius: 16px;\nmargin-top: 20px;\n"]))),Pn=tn.a.input(k||(k=Object(nn.a)(["\noutline: none;\nwidth: 100%;\nfont-family: inherit;\nbackground: url(",") right 24px center/18px no-repeat, #ffffff;\nbox-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\nborder-radius: 16px;\nborder: 0;\npadding: 8px 24px 8px 12px;\ntext-align: center;\ncolor: var(--text-dark);\n&::placeholder {\n  color: var(--text-medium);\n}\n","\n"])),en,rn("\nfont-size: 18px;\npadding: 12px 30px 12px 12px;\nbackground-size: 22px;\n")),Ln=tn.a.div(S||(S=Object(nn.a)(["\n  position: relative;\n  display: inline-block;\n  width: 100%;\n  ","\n"])),rn("\n    width: 300px;\n  ")),Mn=tn.a.ul(C||(C=Object(nn.a)(["\n  position: absolute;\n  z-index: 1001;\n  top: calc(100% + 16px);\n  box-shadow: 4px 4px 25px rgba(148, 148, 148, 0.25);\n  border-radius: 16px;\n  overflow: hidden;\n  list-style: none;\n  padding: 0;\n  margin: 0;\n  width: 100%;\n  max-height: 140px;\n  overflow-y: scroll;\n  &::-webkit-scrollbar {\n    width: 8px;\n  }\n  &::-webkit-scrollbar-thumb {\n    background: ",";\n    border-radius: 6px;\n    border: 2px solid #F5F6FF;\n  }\n  &::-webkit-scrollbar-track {\n    background: #ffffff;\n    border: 2px solid #F5F6FF;\n  }\n"])),sn),An=tn.a.li(F||(F=Object(nn.a)(["\n font-size: 18px;\n padding: 12px;\n text-align: center;\n cursor: pointer;\n background: #fff;\n &:nth-child(odd) {\n  background: #F5F6FF;\n }\n &:hover {\n  background: ",";\n }\n"])),ln),Un=tn.a.div(D||(D=Object(nn.a)(["\ntext-align: center;\nbackground: url(",") center bottom 10%/cover no-repeat;\nheight: 30vw;\nmin-height: 240px;\nmax-height: 340px;\npadding: 60px 30px;\n"])),on),Zn=tn.a.div(I||(I=Object(nn.a)(["\ncolor: #bfcdff;\nfont-size: 18px;\nletter-spacing: 0.05em;\n"]))),_n=tn.a.div(E||(E=Object(nn.a)(["\ndisplay: flex;\nalign-items:center;\nflex-wrap: wrap;\njustify-content: flex-end;\nmargin-bottom: 16px;\n"," {\n  width: 160px;\n  margin-bottom: 10px;\n}\n","\n"])),Ln,rn("\njustify-content: space-between;\n> h1 {\n  order: -1;\n}\n".concat(Ln," {\n  width: 310px;\n  margin-bottom: 0px;\n}\n"))),Hn=tn.a.div(T||(T=Object(nn.a)(["\n","\n"])),rn("\nheight: calc(100vh - 200px);\nmin-height: 650px;\ndisplay:flex;\n")),qn=tn.a.div(N||(N=Object(nn.a)(["\nflex-basis: 380px;\ndisplay: flex;\nflex-direction: column;\nmargin-bottom: 28px;\n","\n> div {\n  flex: 1;\n  max-height:calc(50% - 14px);\n  > div {\n    height: 100%;\n  }\n  &:first-child {\n    margin-bottom: 28px;\n  }\n}\n"," {\n  height: 100%;\n  min-height: 240px;\n  max-height: none;\n  padding: 40px 20px;\n","\n}\n"])),rn("\nmargin-right: 28px;\nmargin-bottom: 0px;\n"),Un,rn("\n  min-height: auto;\n")),Gn=tn.a.div(z||(z=Object(nn.a)(["\nflex: 1;\n"]))),Wn=tn.a.div(R||(R=Object(nn.a)(["\nposition: absolute;\nleft: 50%;\ntop: 30%;\ntransform: translate(-50%, 0);\nfont-size: 72px;\ncolor: #fff;\n"]))),$n=tn.a.div(B||(B=Object(nn.a)(["\ndisplay: flex;\nalign-items: center;\npadding: 12px 6px;\nposition: relative;\n+ div {\n  border-top: 1px dashed transparent;\n  border-image: url('","') 1 1 round;\n}\n> img {\n  width: 20px;\n  margin-right: 16px;\n}\n&:after{\n  content: '';\n  border-top: 11px solid var(--text-light);\n  border-left: 8px solid transparent;\n  border-right: 8px solid transparent;\n  position: absolute;\n  top: 50%;\n  margin-top: -6px;\n  right: 32px;\n  z-index: 1;\n}\n"," {\n  top: calc(100% - 4px);\n  max-height: 125px;\n  max-width: 230px;\n}\n"," {\n  padding: 8px 12px;\n}\n"," {\n  background: none;\n  box-shadow: none;\n  font-weight: bold;\n  text-align: left;\n  font-size: 14px;\n  color: var(--text-dark);\n  &::placeholder {\n    color: var(--text-light);\n  }\n}\n"])),cn,Mn,An,Pn),Jn=tn.a.button(P||(P=Object(nn.a)(["\nborder-radius: 20px;\nbackground: var(--light);\ntext-align: center;\ncolor: #fff;\npadding: 0.5em 1em;\nfont-weight: bold;\nfont-size: 16px;\nborder: 0;\nwidth: 90%;\ndisplay: block;\nmargin: 1em auto 0;\ncursor: pointer;\n"]))),Kn=tn.a.div(L||(L=Object(nn.a)(["\nheight: 100%;\nmin-height: 360px;\nbox-shadow: 1px 4px 15px rgba(140, 140, 140, 0.25);\nborder-radius: 16px;\n.icon-number {\n  width: 24px;\n  height: 24px;\n  border-radius: 50%;\n  border: 2px solid #fff;\n  background: var(--light);\n  color: #fff;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n  font-weight: bold;\n  box-shadow: 2px 4px 4px rgba(0, 0, 0, 0.25);\n}\n.icon-bus {\n  padding: 6px;\n  border-radius: 6px;\n  font-size: 10px;\n  text-align: center;\n  width: 72px;\n  background: var(--light);\n  color: #fff;\n  > img {\n    display: block;\n    margin: 0 auto;\n  }\n}\n"]))),Vn=function(){return Object(W.jsxs)(Fn,{children:[Object(W.jsx)(Dn,{to:"/",children:Object(W.jsx)("img",{src:V})}),Object(W.jsxs)(In,{children:[Object(W.jsx)(En,{children:Object(W.jsx)(Tn,{to:"nearby",children:Object(W.jsx)("img",{src:X})})}),Object(W.jsx)(En,{children:Object(W.jsx)(Tn,{to:"search",children:Object(W.jsx)("img",{src:Y})})}),Object(W.jsx)(En,{children:Object(W.jsx)(Tn,{to:"news",children:Object(W.jsx)("img",{src:Q})})})]})]})},Yn=e(9),Xn=e(38),Qn=e(6),nt=e.n(Qn),tt=e(34),et=e.n(tt),at=e.p+"static/media/ic-point.821431dd.svg",it=e.p+"static/media/ic-map-marker.775b9a87.svg",ot=e.p+"static/media/ic-bus.cd4a572c.svg",ct=e(18),rt=e.n(ct),lt=e(39),st=e(35),ut=e(36),dt=e.n(ut),pt=e(37),bt=["method","url"],xt=function(){var n=U.a.useState(!1),t=Object(G.a)(n,2),e=t[0],a=t[1];return U.a.useEffect((function(){if("undefined"!==typeof window){var n=function(){a("undefined"===typeof window||window.innerWidth<1024)};return window.addEventListener("resize",n),n(),function(){return window.removeEventListener("resize",n)}}}),[]),e},ht=function(){var n=(new Date).toGMTString(),t=new pt.a("SHA-1","TEXT");return t.setHMACKey(pn,"TEXT"),t.update("x-date: ".concat(n)),{HMAC:t.getHMAC("B64"),GMTString:n}},ft=function(){var n=Object(st.a)(rt.a.mark((function n(t){var e,a,i,o,c,r,l,s,u,d;return rt.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return e=t.method,a=void 0===e?"get":e,i=t.url,o=Object(lt.a)(t,bt),c=ht(),r=c.HMAC,l=c.GMTString,s=null,n.prev=3,n.next=6,dt()(Object(Yn.a)({method:a,url:"".concat("https://ptx.transportdata.tw/MOTC").concat(i,"&$format=JSON"),responseType:"json",headers:{Authorization:'hmac username="'.concat(dn,'", algorithm="hmac-sha1", headers="x-date", signature="').concat(r,'"'),"x-date":l}},o));case 6:u=n.sent,d=u.data,s=d,n.next=14;break;case 11:n.prev=11,n.t0=n.catch(3),console.log("api error: ",n.t0);case 14:return n.abrupt("return",s);case 15:case"end":return n.stop()}}),n,null,[[3,11]])})));return function(t){return n.apply(this,arguments)}}(),gt=function(){var n=J(),t=n.locationData,e=n.setLocationData;return{locationData:t,getPosition:function(){navigator.geolocation.getCurrentPosition((function(n){e({lat:n.coords.latitude,lng:n.coords.longitude})}))}}},mt=function(){var n=Object(H.g)(),t=U.a.useState([]),e=Object(G.a)(t,2),a=e[0],i=e[1],o=U.a.useState(!1),c=Object(G.a)(o,2),r=c[0],l=c[1],s=U.a.useRef(null);return U.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==s.current&&l(!1)};return r&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[r]),U.a.useEffect((function(){a.length>0&&l(!0)}),[a]),Object(W.jsxs)(Ln,{children:[Object(W.jsx)(Pn,{ref:s,type:"text",placeholder:"\u5feb\u901f\u641c\u5c0b",onChange:function(n){var t;n.target.value?(t=n.target.value,ft({url:"/v2/Bus/Route/City/Taipei/".concat(t,"?$top=10")}).then((function(n){i(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}))):i([])},onFocus:function(){return l(!0)}}),r&&Object(W.jsx)(Mn,{children:a.map((function(t){return Object(W.jsx)(An,{onClick:function(){return e=t.value,void n("/search/Taipei/".concat(e));var e},children:t.label},t.label)}))})]})},jt=function(n){var t=n.options,e=n.placeholder,a=n.onSelect,i=n.icon,o=U.a.useState(""),c=Object(G.a)(o,2),r=c[0],l=c[1],s=U.a.useState(!1),u=Object(G.a)(s,2),d=u[0],p=u[1],b=U.a.useState([]),x=Object(G.a)(b,2),h=x[0],f=x[1],g=U.a.useRef(null);return U.a.useEffect((function(){var n=document.getElementById("root"),t=function(n){n.target!==g.current&&p(!1)};return d&&n.addEventListener("click",t),function(){n.removeEventListener("click",t)}}),[d]),U.a.useEffect((function(){t.length>0&&f(t)}),[t]),Object(W.jsxs)($n,{children:[Object(W.jsx)("img",{src:i,alt:""}),Object(W.jsxs)(Ln,{children:[Object(W.jsx)(Pn,{ref:g,type:"text",value:r,placeholder:e,onChange:function(n){l(n.target.value),p(!0),n.target.value?f(t.filter((function(t){return t.label.includes(n.target.value)}))):f(t)},onFocus:function(){return p(!0)},autocomplete:"off"}),d&&Object(W.jsx)(Mn,{children:h.map((function(n){return Object(W.jsx)(An,{onClick:function(){return l((t=n).label),void a(t.value);var t},children:n.label},n.label)}))})]})]})},vt=function(n){var t=n.text,e=void 0===t?"\u6c92\u6709\u8cc7\u6599":t;return Object(W.jsx)(Un,{children:Object(W.jsx)(Zn,{children:e})})},Ot=e(19),yt=e.n(Ot),wt={0:"\u6b63\u5e38",1:"\u5c1a\u672a\u767c\u8eca",2:"\u4ea4\u7ba1\u4e0d\u505c\u9760",3:"\u672b\u73ed\u8eca\u5df2\u904e",4:"\u4eca\u65e5\u672a\u71df\u904b"};nt.a.NumberedIcon=nt.a.Icon.extend({options:{number:"",className:"icon-number",iconAnchor:[12,12],popupAnchor:[0,-12]},createIcon:function(){var n=document.createElement("div");return n.innerHTML=this.options.number||"",this._setIconStyles(n,"icon"),n}}),nt.a.BusIcon=nt.a.Icon.extend({options:{plateNumb:"",className:"icon-bus",iconAnchor:[36,18],popupAnchor:[0,-18]},createIcon:function(){var n=document.createElement("div"),t=document.createElement("img");return t.setAttribute("src",ot),n.appendChild(t),n.append(this.options.plateNumb||""),this._setIconStyles(n,"icon"),n}});var kt,St=nt.a.layerGroup(),Ct=nt.a.layerGroup(),Ft=function(){var n,t,e=gt(),a=e.locationData,i=e.getPosition,o=U.a.useRef(),c=Object(H.g)(),r=Object(H.h)(),l=r.city,s=r.route,u=U.a.useState(""),d=Object(G.a)(u,2),p=d[0],b=d[1],x=U.a.useState(null),h=Object(G.a)(x,2),f=h[0],g=h[1],m=U.a.useState([]),j=Object(G.a)(m,2),v=j[0],O=j[1],y=U.a.useState([]),w=Object(G.a)(y,2),k=w[0],S=w[1],C=U.a.useState([]),F=Object(G.a)(C,2),D=F[0],I=F[1],E=U.a.useState(null),T=Object(G.a)(E,2),N=T[0],z=T[1],R=U.a.useState([]),B=Object(G.a)(R,2),P=B[0],L=B[1],A=U.a.useState(""),Z=Object(G.a)(A,2),_=Z[0],q=Z[1],$=U.a.useState(0),J=Object(G.a)($,2),K=J[0],V=J[1],Y=xt(),X=function(n,t,e){Promise.all([ft({url:"/v2/Bus/RealTimeByFrequency/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),ft({url:"/v2/Bus/RealTimeNearStop/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),ft({url:"/v2/Bus/EstimatedTimeOfArrival/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")})]).then((function(n){var t=Object(G.a)(n,3),a=t[0],i=t[1],o=t[2],c=Object(Xn.a)(e);i.length>0&&i.forEach((function(n){var t=c.findIndex((function(t){return t.Direction===n.Direction&&t.SubRouteUID===n.SubRouteUID}));t>-1&&(c[t].Stops[n.StopSequence-1].BusPlate=n.PlateNumb,c[t].Stops[n.StopSequence-1].busStatus=n.DutyStatus)})),o.forEach((function(n){var t,e,a,i=n.EstimateTime?parseInt(n.EstimateTime/60):0,o=c.findIndex((function(t){return 255===n.Direction&&t.SubRouteUID===n.SubRouteUID||t.Direction===n.Direction&&t.RouteUID===n.RouteUID})),r=null===(t=c[o])||void 0===t?void 0:t.Stops.findIndex((function(t){return t.StopUID===n.StopUID}));r>-1&&(c[o].Stops[r].status=n.StopStatus?wt[n.StopStatus]:"".concat(i>1?"\u7d04".concat(i,"\u5206"):"\u9032\u7ad9\u4e2d")),1===(null===(e=c[o])||void 0===e||null===(a=e.Stops[r])||void 0===a?void 0:a.busStatus)&&(c[o].Stops[r].status="\u9032\u7ad9\u4e2d")})),S(a),I(c)}))};U.a.useEffect((function(){p||b(yt()(new Date).format("HH:mm"));var n=setInterval((function(){b(yt()(new Date).format("HH:mm"))}),2e3);return function(){clearInterval(n)}}),[p]),U.a.useEffect((function(){var n,t;l&&s?(n=l,t=s,Promise.all([ft({url:"/v2/Bus/Route/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),ft({url:"/v2/Bus/StopOfRoute/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")}),ft({url:"/v2/Bus/Shape/City/".concat(n,"?$filter=RouteUID eq '").concat(t,"'")})]).then((function(n){var t=Object(G.a)(n,4),e=t[0],a=t[1],i=t[2],o=t[3];console.log("f",o);var c=e[0],r=a.map((function(n){return Object(Yn.a)(Object(Yn.a)({},n),{},{destination:0===n.Direction?c.DestinationStopNameZh:c.DepartureStopNameZh})}));z(c),q(i[0].Geometry),L(r.filter((function(n,t){return t<2})))}))):(z(null),q(""),L([]))}),[l,s]),U.a.useEffect((function(){P.length>0&&X(l,s,P)}),[P]),U.a.useEffect((function(){return _?(M=function(n,t){var e=nt.a.GeoJSON.coordsToLatLngs(et()(t).coordinates),a=nt.a.polyline(e,{color:sn}),i=a.getBounds(),o=i.getCenter(),c=nt.a.map(n).setView([o.lat,o.lng],15);return nt.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:bn}).addTo(c),a.addTo(c),c.fitBounds(i),c}(o.current,_),console.log("aaa")):(M=function(n,t){var e=nt.a.map(n).setView([t?t.lat:25.04454809288478,t?t.lng:121.53947779457634],13);return nt.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:bn}).addTo(e),e}(o.current,a),console.log("bbb")),function(){M&&M.remove()}}),[_,a]),U.a.useEffect((function(){var n;if(k.length>0){var t=function(){var n;X(l,s,P),k.map((function(n){return n.Direction})).includes(K)&&(n=k.filter((function(n){return n.Direction===K})),St.clearLayers(),n.forEach((function(n,t){var e=n.BusPosition,a=e.PositionLat,i=e.PositionLon;nt.a.marker([a,i],{icon:new nt.a.BusIcon({plateNumb:n.PlateNumb})}).addTo(St).bindPopup("".concat(n.Speed," kph"))})),St.addTo(M))};t(),n=setInterval(t,1e4)}return function(){clearInterval(n)}}),[k,K]),U.a.useEffect((function(){var n;P.length>0&&(n=P[K].Stops,Ct.clearLayers(),n.forEach((function(n,t){var e=n.StopPosition,a=e.PositionLat,i=e.PositionLon;nt.a.marker([a,i],{icon:new nt.a.NumberedIcon({number:n.StopSequence})}).addTo(Ct).bindPopup(n.StopName.Zh_tw)})),Ct.addTo(M))}),[K,P]),U.a.useEffect((function(){i()}),[]);var Q=null===(n=xn.find((function(n){return n.key===(null===N||void 0===N?void 0:N.City)})))||void 0===n?void 0:n.name;return Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(_n,{children:[Object(W.jsx)(mt,{}),Object(W.jsxs)(gn,{children:["Route Search ",Object(W.jsx)(vn,{})," ",N?"".concat(Q," - ").concat(N.RouteName.Zh_tw):" \u8def\u7dda\u641c\u5c0b "]})]}),Object(W.jsxs)(Hn,{children:[Object(W.jsxs)(qn,{children:[Object(W.jsx)("div",{children:Object(W.jsxs)(On,{style:{padding:Y?"30px 30px 20px":"40px 30px 30px",overflow:"visible"},children:[Object(W.jsx)(mn,{style:{fontFamily:"DM Sans, Roboto, sans-serif",fontSize:24,marginBottom:"0.5em"},children:"Where are you going?"}),Object(W.jsx)(jt,{options:xn.map((function(n){return{label:n.name,value:n.key}})),placeholder:"\u9078\u64c7 \u7e23\u5e02",onSelect:function(n){return t=n,g(Object(Yn.a)(Object(Yn.a)({},f),{},{city:t})),void ft({url:"/v2/Bus/Route/City/".concat(t,"?")}).then((function(n){O(null===n||void 0===n?void 0:n.map((function(n){return{value:n.RouteUID,label:n.RouteName.Zh_tw}})).sort((function(n,t){return n.label.localeCompare(t.label)})))}));var t},icon:at}),Object(W.jsx)(jt,{options:v,placeholder:"\u9078\u64c7 \u8def\u7dda",onSelect:function(n){return g(Object(Yn.a)(Object(Yn.a)({},f),{},{route:n}))},icon:it}),Object(W.jsx)(Jn,{onClick:function(){var n=f.city,t=f.route;c("/search/".concat(n,"/").concat(t))},type:"button",children:"\u641c\u5c0b"})]})}),Y&&Object(W.jsx)(Kn,{ref:o,style:{marginBottom:28}}),Object(W.jsx)("div",{children:l&&s?Object(W.jsxs)(On,{children:[Object(W.jsx)(Cn,{size:"small",children:P.map((function(n,t){return Object(W.jsxs)("li",{className:K===t?"active":"",onClick:function(){V(t)},children:["\u5f80 ",null===n||void 0===n?void 0:n.destination]},"".concat(n.Direction,"-").concat(n.SubRouteUID))}))}),Object(W.jsx)(wn,{children:null===(t=D[K])||void 0===t?void 0:t.Stops.map((function(n){return Object(W.jsxs)("li",{children:[Object(W.jsx)("span",{children:n.StopName.Zh_tw}),Object(W.jsx)(kn,{children:n.status}),n.BusPlate&&Object(W.jsx)(Sn,{children:n.BusPlate})]},n.StopID)}))})]}):Object(W.jsxs)(On,{children:[Object(W.jsx)(vt,{text:"\u60a8\u9084\u6c92\u8f38\u5165\u8def\u7dda\u8cc7\u8a0a\u5594\uff01"}),Object(W.jsx)(Wn,{children:p})]})})]}),!Y&&Object(W.jsx)(Gn,{children:Object(W.jsx)(Kn,{ref:o})})]})]})},Dt=e.p+"static/media/user-marker.4fc68668.svg",It=e.p+"static/media/ic-map-marker-main.dfbf20a3.svg",Et=function(n){var t=n.data,e=n.close,a=U.a.useRef(),i=J().locationData;return U.a.useEffect((function(){return kt=function(n,t){var e=n.PositionLat,a=n.PositionLon,o=nt.a.map(t).setView([e,a],15);return nt.a.tileLayer("https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token={accessToken}",{attribution:'Map data &copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors, Imagery \xa9 <a href="https://www.mapbox.com/">Mapbox</a>',maxZoom:18,id:"allychen/ckw5waap41dl514o4rcpa1nsn",tileSize:512,zoomOffset:-1,accessToken:bn}).addTo(o),nt.a.marker([e,a],{icon:nt.a.icon({iconUrl:It,iconAnchor:[10,23],popupAnchor:[0,-23]})}).addTo(o),i&&nt.a.marker([i.lat,i.lng],{icon:nt.a.icon({iconUrl:Dt,iconAnchor:[15,34],popupAnchor:[0,-34]})}).addTo(o),o}(t.StationPosition,a.current),function(){kt.remove()}}),[]),Object(W.jsx)(Nn,{onClick:e,children:Object(W.jsx)(zn,{children:Object(W.jsxs)(Rn,{onClick:function(n){return n.stopPropagation()},children:[Object(W.jsxs)(jn,{children:[t.StationName.Zh_tw," - ",un[t.Bearing]]}),"\u884c\u7d93\u8def\u7dda\uff1a",t.Stops.map((function(n){return n.RouteName.Zh_tw})).join(", "),Object(W.jsx)(Bn,{ref:a})]})})})},Tt=function(){var n=U.a.useState(300),t=Object(G.a)(n,2),e=t[0],a=t[1],i=U.a.useState([]),o=Object(G.a)(i,2),c=o[0],r=o[1],l=U.a.useState(null),s=Object(G.a)(l,2),u=s[0],d=s[1],p=gt(),b=p.locationData,x=p.getPosition,h=xt();return U.a.useEffect((function(){x()}),[]),U.a.useEffect((function(){b&&e&&function(n){var t=n.lat,e=n.lng,a=n.distance;ft({url:"/v2/Bus/Station/NearBy?$spatialFilter=nearby(".concat(t,",").concat(e,",").concat(a,")")}).then((function(n){r(n.filter((function(n,t,e){return e.findIndex((function(t){return t.StationID===n.StationID}))===t})))}))}(Object(Yn.a)(Object(Yn.a)({},b),{},{distance:e}))}),[b,e]),Object(W.jsxs)(W.Fragment,{children:[Object(W.jsxs)(_n,{children:[Object(W.jsx)(mt,{}),Object(W.jsxs)(gn,{children:["Bus Stop ",Object(W.jsx)(vn,{})," \u9644\u8fd1\u7ad9\u724c"]})]}),Object(W.jsxs)(On,{style:{padding:h?"40px 30px":"50px 70px",marginTop:20},children:[Object(W.jsx)(mn,{children:"\u9644\u8fd1\u7684\u7ad9\u724c"}),Object(W.jsxs)(Cn,{children:[Object(W.jsx)("li",{className:300===e?"active":"",onClick:function(){return a(300)},children:"300 m"}),Object(W.jsx)("li",{className:10===e?"active":"",onClick:function(){return a(10)},children:"100 m"})]}),c.length>0?Object(W.jsx)(yn,{children:c.map((function(n,t){var e,a;return Object(W.jsx)("li",{children:Object(W.jsxs)(q.b,{to:"#",onClick:function(t){return function(n,t){n.preventDefault(),d(t)}(t,n)},children:[Object(W.jsxs)(jn,{children:[null===(e=n.StationName)||void 0===e?void 0:e.Zh_tw," (",n.Bearing,")"]}),null===n||void 0===n||null===(a=n.Stops)||void 0===a?void 0:a.map((function(n){var t;return null===n||void 0===n||null===(t=n.RouteName)||void 0===t?void 0:t.Zh_tw})).join(", ")]})},n.StationUID)}))}):Object(W.jsx)(vt,{text:"\u9644\u8fd1\u6c92\u6709\u7ad9\u724c"})]}),u&&Object(W.jsx)(Et,{data:u,close:function(){d(null)}})]})},Nt=function(){return Object(W.jsxs)(gn,{children:["Latest News ",Object(W.jsx)(vn,{})," \u6700\u65b0\u6d88\u606f"]})},zt=function(){return Object(W.jsxs)(hn,{children:[Object(W.jsx)(Vn,{}),Object(W.jsx)(fn,{children:Object(W.jsx)(H.a,{})})]})},Rt=function(){return Object(W.jsx)(K,{children:Object(W.jsx)(q.a,{children:Object(W.jsx)(H.d,{children:Object(W.jsxs)(H.b,{path:"/",element:Object(W.jsx)(zt,{}),children:[Object(W.jsxs)(H.b,{path:"search",children:[Object(W.jsx)(H.b,{path:":city",element:Object(W.jsx)(Ft,{})}),Object(W.jsx)(H.b,{path:":city/:route",element:Object(W.jsx)(Ft,{})}),Object(W.jsx)(H.b,{index:!0,element:Object(W.jsx)(Ft,{})})]}),Object(W.jsx)(H.b,{path:"nearby",element:Object(W.jsx)(Tt,{})}),Object(W.jsx)(H.b,{path:"news",element:Object(W.jsx)(Nt,{})}),Object(W.jsx)(H.b,{index:!0,element:Object(W.jsx)(Ft,{})})]})})})})},Bt=function(n){n&&n instanceof Function&&e.e(3).then(e.bind(null,69)).then((function(t){var e=t.getCLS,a=t.getFID,i=t.getFCP,o=t.getLCP,c=t.getTTFB;e(n),a(n),i(n),o(n),c(n)}))};_.a.render(Object(W.jsx)(U.a.StrictMode,{children:Object(W.jsx)(Rt,{})}),document.getElementById("root")),Bt()}},[[68,1,2]]]);
//# sourceMappingURL=main.c2af7730.chunk.js.map